"use strict";exports.id=521,exports.ids=[521],exports.modules={87521:(e,t,a)=>{a.d(t,{AU:()=>D,CP:()=>v,Cr:()=>L,DK:()=>ei,E7:()=>f,Ew:()=>g,G7:()=>_,GD:()=>J,IF:()=>eg,Ir:()=>w,Ix:()=>V,JY:()=>et,Ju:()=>G,KM:()=>Y,LD:()=>$,LX:()=>K,OA:()=>u,OL:()=>I,RD:()=>ea,RY:()=>O,Rw:()=>ec,TA:()=>M,TE:()=>B,Vb:()=>er,WO:()=>eu,Xp:()=>h,Zl:()=>j,_:()=>Q,bS:()=>N,c5:()=>en,co:()=>P,createCustomer:()=>C,createOrder:()=>y,db:()=>l,e5:()=>x,fS:()=>ed,gH:()=>z,gK:()=>m,getCustomerByPhone:()=>E,hv:()=>X,i8:()=>b,ix:()=>es,j7:()=>ee,jw:()=>R,kF:()=>q,nM:()=>p,o1:()=>W,qc:()=>eo,qu:()=>em,rI:()=>el,s3:()=>Z,updateCustomer:()=>k,uu:()=>A,wS:()=>H,yr:()=>S,zH:()=>U});var r=a(76041),i=a(48853),o=a(87097),n=a(73424);let s=(0,r.ZF)({apiKey:"AIzaSyDIHawXZZfiYMhBUznsnbXS0LOId9u5FLA",authDomain:"bagichaa-app.firebaseapp.com",projectId:"bagichaa-app",storageBucket:"bagichaa-app.firebasestorage.app",messagingSenderId:"868520218471",appId:"1:868520218471:web:d333c48ee8d01e2b1b69c2"}),c=(0,i.v0)(s),l=(0,o.ad)(s),d=(0,n.cF)(s);c.useDeviceLanguage();let g=e=>{let t=document.getElementById(e);return t&&(t.innerHTML=""),new i.lI(c,e,{size:"invisible",callback:()=>{},"expired-callback":()=>{}})},u=async(e,t)=>{try{if(!t)throw Error("reCAPTCHA verifier is required");return await (0,i.$g)(c,e,t)}catch(e){if("auth/billing-not-enabled"===e.code)throw Error("SMS service not enabled. Please contact support.");if("auth/too-many-requests"===e.code)throw Error("Too many attempts. Please try again later.");if("auth/invalid-phone-number"===e.code)throw Error("Invalid phone number format.");if("auth/missing-phone-number"===e.code)throw Error("Phone number is required.");else if("auth/quota-exceeded"===e.code)throw Error("SMS quota exceeded. Please try again later.");throw e}},m=async e=>{try{return(await (0,o.ET)((0,o.hJ)(l,"products"),{...e,createdAt:new Date,updatedAt:new Date})).id}catch(e){throw e}},p=async(e,t)=>{try{let a=(0,o.JU)(l,"products",e);await (0,o.r7)(a,{...t,updatedAt:new Date})}catch(e){throw e}},w=async e=>{try{await (0,o.oe)((0,o.JU)(l,"products",e))}catch(e){throw e}},h=async()=>{try{return(await (0,o.PL)((0,o.hJ)(l,"products"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},y=async e=>{try{return(await (0,o.ET)((0,o.hJ)(l,"orders"),{...e,status:"pending",createdAt:new Date,updatedAt:new Date})).id}catch(e){throw e}},f=async(e,t)=>{try{let a=(0,o.JU)(l,"orders",e);await (0,o.r7)(a,{status:t,updatedAt:new Date})}catch(e){throw e}},D=async()=>{try{let e=(0,o.IO)((0,o.hJ)(l,"orders"),(0,o.Xo)("createdAt","desc"));return(await (0,o.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},P=async e=>{try{let t=await (0,o.QT)((0,o.JU)(l,"orders",e));if(t.exists())return{id:t.id,...t.data()};return null}catch(e){throw e}},b=async e=>{try{return(await (0,o.ET)((0,o.hJ)(l,"categories"),{...e,createdAt:new Date,updatedAt:new Date})).id}catch(e){throw e}},v=async()=>{try{return(await (0,o.PL)((0,o.hJ)(l,"categories"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},S=async(e,t)=>{try{let a=(0,o.JU)(l,"categories",e);await (0,o.r7)(a,{...t,updatedAt:new Date})}catch(e){throw e}},A=async e=>{try{await (0,o.oe)((0,o.JU)(l,"categories",e))}catch(e){throw e}},O=e=>{let t=(0,o.IO)((0,o.hJ)(l,"orders"),(0,o.Xo)("createdAt","desc"));return(0,o.cf)(t,t=>{e(t.docs.map(e=>({id:e.id,...e.data()})))})},C=async e=>{try{return(await (0,o.ET)((0,o.hJ)(l,"customers"),{...e,createdAt:new Date,updatedAt:new Date,totalOrders:0,totalSpent:0,lastOrderDate:null,loyaltyPoints:0,preferredCategories:[],averageOrderValue:0})).id}catch(e){throw e}},k=async(e,t)=>{try{let a=(0,o.JU)(l,"customers",e);await (0,o.r7)(a,{...t,updatedAt:new Date})}catch(e){throw e}},I=async()=>{try{let e=(0,o.IO)((0,o.hJ)(l,"customers"),(0,o.Xo)("totalSpent","desc"));return(await (0,o.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},E=async e=>{try{let t=(0,o.IO)((0,o.hJ)(l,"customers"),(0,o.ar)("phone","==",e)),a=await (0,o.PL)(t);if(!a.empty){let e=a.docs[0];return{id:e.id,...e.data()}}return null}catch(e){throw e}},J=async e=>{try{let t=(0,o.IO)((0,o.hJ)(l,"orders"),(0,o.ar)("customerId","==",e),(0,o.Xo)("createdAt","desc"));return(await (0,o.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},L=async(e,t,a)=>{try{let r=(0,o.JU)(l,"orders",e),i=await (0,o.QT)(r);if(i.exists()){let e=i.data().notes||[],n={id:Date.now().toString(),note:t,addedBy:a,addedAt:new Date};await (0,o.r7)(r,{notes:[...e,n],updatedAt:new Date})}}catch(e){throw e}},T=async(e,t)=>{try{let a=(0,o.IO)((0,o.hJ)(l,"orders"),(0,o.ar)("createdAt",">=",e),(0,o.ar)("createdAt","<=",t),(0,o.Xo)("createdAt","desc"));return(await (0,o.PL)(a)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},M=async(e,t)=>{try{let a=[];for(let r of e){let e=(0,o.JU)(l,"orders",r);a.push((0,o.r7)(e,{status:t,updatedAt:new Date}))}await Promise.all(a)}catch(e){throw e}},F=async(e="month")=>{try{let t=new Date,a=new Date;switch(e){case"day":a.setDate(t.getDate()-30);break;case"week":a.setDate(t.getDate()-84);break;case"month":a.setMonth(t.getMonth()-12);break;case"year":a.setFullYear(t.getFullYear()-5)}let[r,i,o]=await Promise.all([T(a,t),h(),I()]);return{orders:r,products:i,customers:o,period:e,dateRange:{startDate:a,endDate:t}}}catch(e){throw e}},U=async(e="month")=>{try{let{orders:t}=await F(e),a=new Map,r=new Map,i=new Map,o=0,n=t.length,s=0;return t.forEach(t=>{let n=t.createdAt?.toDate()||new Date(t.createdAt),s=t.total||0;o+=s;let c="";switch(e){case"day":c=n.toISOString().split("T")[0];break;case"week":let l=new Date(n);l.setDate(n.getDate()-n.getDay()),c=l.toISOString().split("T")[0];break;case"month":c=`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}`;break;case"year":c=n.getFullYear().toString()}a.set(c,(a.get(c)||0)+s),t.items?.forEach(e=>{let t=(e.price||0)*(e.qty||0);i.set(e.name,(i.get(e.name)||0)+t);let a=e.category||"Other";r.set(a,(r.get(a)||0)+t)})}),s=n>0?o/n:0,{totalRevenue:o,totalOrders:n,averageOrderValue:s,revenueByPeriod:Array.from(a.entries()).map(([e,t])=>({period:e,revenue:t})),revenueByCategory:Array.from(r.entries()).map(([e,t])=>({category:e,revenue:t})),topProducts:Array.from(i.entries()).map(([e,t])=>({name:e,revenue:t})).sort((e,t)=>t.revenue-e.revenue).slice(0,10)}}catch(e){throw e}},R=async()=>{try{let[e,t]=await Promise.all([I(),D()]);if(!e||0===e.length)return{totalCustomers:0,segments:{new:0,active:0,inactive:0,churned:0},averageLifetimeValue:0,geographicDistribution:[],topCustomers:[]};let a={new:0,active:0,inactive:0,churned:0},r=new Map,i=new Map,o=new Map,n=new Date;e.forEach(e=>{let t=e.lastOrderDate;t=t?t.toDate?t.toDate():new Date(t):e.createdAt?e.createdAt.toDate?e.createdAt.toDate():new Date(e.createdAt):new Date;let s=(n.getTime()-t.getTime())/864e5;s<=30?a.new++:s<=90?a.active++:s<=180?a.inactive++:a.churned++,r.set(e.id,e.totalSpent||0),i.set(e.id,e.totalOrders||0);let c=`${e.city||"Unknown"}, ${e.state||"Unknown"}`;o.set(c,(o.get(c)||0)+1)});let s=e.reduce((e,t)=>e+(t.totalSpent||0),0),c=e.length>0?s/e.length:0;return{totalCustomers:e.length,segments:a,averageLifetimeValue:c,geographicDistribution:Array.from(o.entries()).map(([e,t])=>({location:e,count:t})),topCustomers:e.slice(0,10).map(e=>({id:e.id,name:e.name,phone:e.phone,totalSpent:e.totalSpent||0,totalOrders:e.totalOrders||0}))}}catch(e){return{totalCustomers:0,segments:{new:0,active:0,inactive:0,churned:0},averageLifetimeValue:0,geographicDistribution:[],topCustomers:[]}}},x=async()=>{try{let[e,t]=await Promise.all([h(),D()]),a=new Map,r=new Map;e.forEach(e=>{a.set(e.id,{name:e.name,category:e.category,price:e.price,inventory:e.inventory||0,sold:0,revenue:0})}),t.forEach(e=>{e.items?.forEach(e=>{let t=e.productId||e.id;if(a.has(t)){let i=a.get(t);i.sold+=e.qty||0,i.revenue+=(e.price||0)*(e.qty||0);let o=i.category||"Other",n=r.get(o)||{sold:0,revenue:0};n.sold+=e.qty||0,n.revenue+=(e.price||0)*(e.qty||0),r.set(o,n)}})});let i=Array.from(a.values()).sort((e,t)=>t.sold-e.sold).slice(0,10),o=Array.from(a.values()).sort((e,t)=>t.revenue-e.revenue).slice(0,10);return{totalProducts:e.length,topSellingProducts:i,topRevenueProducts:o,categoryPerformance:Array.from(r.entries()).map(([e,t])=>({category:e,...t})),lowStockAlerts:Array.from(a.values()).filter(e=>e.inventory<10)}}catch(e){throw e}},B=e=>{let t=(0,o.IO)((0,o.hJ)(l,"customers"),(0,o.Xo)("totalSpent","desc"));return(0,o.cf)(t,t=>{e(t.docs.map(e=>({id:e.id,...e.data()})))})},G=e=>{let t=(0,o.IO)((0,o.hJ)(l,"orders"),(0,o.Xo)("createdAt","desc"),(0,o.b9)(100));return(0,o.cf)(t,async t=>{let a=t.docs.map(e=>({id:e.id,...e.data()})),r=a.reduce((e,t)=>e+(t.total||0),0),i=a.length;e({totalRevenue:r,totalOrders:i,averageOrderValue:i>0?r/i:0,statusCounts:a.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),recentOrders:a.slice(0,10)})})},H=async()=>{try{let e=[{name:"Rajesh Kumar",phone:"+91-9876543210",email:"rajesh.kumar@email.com",city:"Delhi",state:"Delhi",totalOrders:5,totalSpent:12500,lastOrderDate:new Date(Date.now()-1296e6),firstOrderDate:new Date(Date.now()-7776e6),loyaltyPoints:125,preferredCategories:["plants","fertilizers"]},{name:"Priya Sharma",phone:"+91-9876543211",email:"priya.sharma@email.com",city:"Mumbai",state:"Maharashtra",totalOrders:8,totalSpent:18750,lastOrderDate:new Date(Date.now()-432e6),firstOrderDate:new Date(Date.now()-10368e6),loyaltyPoints:188,preferredCategories:["plants","tools"]},{name:"Amit Patel",phone:"+91-9876543212",email:"amit.patel@email.com",city:"Bangalore",state:"Karnataka",totalOrders:3,totalSpent:7250,lastOrderDate:new Date(Date.now()-3888e6),firstOrderDate:new Date(Date.now()-648e7),loyaltyPoints:72,preferredCategories:["seeds","fertilizers"]},{name:"Sunita Verma",phone:"+91-9876543213",email:"sunita.verma@email.com",city:"Chennai",state:"Tamil Nadu",totalOrders:12,totalSpent:28900,lastOrderDate:new Date(Date.now()-1728e5),firstOrderDate:new Date(Date.now()-15552e6),loyaltyPoints:289,preferredCategories:["plants","fertilizers","tools"]},{name:"Ravi Singh",phone:"+91-9876543214",city:"Pune",state:"Maharashtra",totalOrders:2,totalSpent:4500,lastOrderDate:new Date(Date.now()-10368e6),firstOrderDate:new Date(Date.now()-1296e7),loyaltyPoints:45,preferredCategories:["seeds"]},{name:"Meera Gupta",phone:"+91-9876543215",email:"meera.gupta@email.com",city:"Kolkata",state:"West Bengal",totalOrders:6,totalSpent:15200,lastOrderDate:new Date(Date.now()-864e6),firstOrderDate:new Date(Date.now()-864e7),loyaltyPoints:152,preferredCategories:["plants","tools"]},{name:"Karan Joshi",phone:"+91-9876543216",email:"karan.joshi@email.com",city:"Ahmedabad",state:"Gujarat",totalOrders:4,totalSpent:9800,lastOrderDate:new Date(Date.now()-2592e6),firstOrderDate:new Date(Date.now()-6912e6),loyaltyPoints:98,preferredCategories:["fertilizers","tools"]},{name:"Deepika Reddy",phone:"+91-9876543217",email:"deepika.reddy@email.com",city:"Hyderabad",state:"Telangana",totalOrders:9,totalSpent:22300,lastOrderDate:new Date(Date.now()-6048e5),firstOrderDate:new Date(Date.now()-11232e6),loyaltyPoints:223,preferredCategories:["plants","fertilizers","seeds"]}],t=[];for(let a of e){let e=await C(a);t.push(e)}return t}catch(e){throw e}},q=async()=>{try{let e=[{name:"Indoor Plants",description:"Perfect plants for your home and office spaces",icon:"\uD83E\uDEB4",subcategories:["Succulents","Ferns","Air Purifying","Low Light","Snake Plants","Pothos","Monstera","Peace Lily"]},{name:"Outdoor Plants",description:"Beautiful plants for gardens and outdoor spaces",icon:"\uD83C\uDF33",subcategories:["Trees","Shrubs","Climbers","Ground Cover","Fruit Trees","Flowering Trees","Shade Trees"]},{name:"Flowering Plants",description:"Vibrant flowers to brighten your space",icon:"\uD83C\uDF38",subcategories:["Roses","Lilies","Marigolds","Jasmine","Sunflowers","Petunias","Orchids","Tulips"]},{name:"Tools",description:"Professional gardening tools and equipment",icon:"\uD83D\uDEE0ï¸",subcategories:["Hand Tools","Watering Tools","Pruning Tools","Digging Tools","Measuring Tools","Protective Gear"]},{name:"Soil & Fertilizer",description:"Organic soil and plant nutrition products",icon:"\uD83E\uDEA8",subcategories:["Potting Mix","Organic Fertilizers","Liquid Fertilizers","Compost","Soil Amendments","Mulch"]},{name:"Pots & Planters",description:"Beautiful containers for your plants",icon:"\uD83C\uDFFA",subcategories:["Ceramic Pots","Plastic Planters","Terracotta Pots","Hanging Planters","Self-Watering","Decorative Pots"]},{name:"Seeds",description:"High-quality seeds for growing your own plants",icon:"\uD83C\uDF3E",subcategories:["Flower Seeds","Vegetable Seeds","Herb Seeds","Grass Seeds","Exotic Seeds","Organic Seeds"]}].map(e=>b(e));return await Promise.all(e),!0}catch(e){return!1}},z=async()=>{try{let e=[{name:"Snake Plant (Sansevieria)",category:"Indoor Plants",subcategory:"Snake Plants",price:599,originalPrice:799,rating:4.8,reviews:234,image:"",badge:"Bestseller",badgeColor:"bg-green-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Air Purifying","Low Maintenance","Low Light Tolerant"],description:"Perfect air-purifying plant for beginners. Thrives in low light and requires minimal watering."},{name:"Monstera Deliciosa",category:"Indoor Plants",subcategory:"Monstera",price:1299,originalPrice:1599,rating:4.9,reviews:156,image:"",badge:"Premium",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!0,features:["Instagram Favorite","Fast Growing","Statement Plant"],description:"Popular tropical houseplant with stunning split leaves. Perfect for bright, indirect light."},{name:"Rose Plant - Red Beauty",category:"Flowering Plants",subcategory:"Roses",price:349,originalPrice:499,rating:4.6,reviews:89,image:"",badge:"New",badgeColor:"bg-blue-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Fragrant Blooms","Long Lasting","Garden Classic"],description:"Beautiful red roses that bloom throughout the season. Perfect for gardens and bouquets."},{name:"Professional Pruning Shears",category:"Tools",subcategory:"Pruning Tools",price:899,originalPrice:1199,rating:4.7,reviews:267,image:"",badge:"Tool of the Month",badgeColor:"bg-orange-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Sharp Blades","Ergonomic Handle","Lifetime Warranty"],description:"Professional-grade pruning shears for precise cuts. Ideal for roses, shrubs, and small branches."},{name:"Organic Potting Mix - 5kg",category:"Soil & Fertilizer",subcategory:"Potting Mix",price:299,originalPrice:399,rating:4.5,reviews:445,image:"",badge:"Organic",badgeColor:"bg-emerald-500",inStock:!0,fastDelivery:!0,organic:!0,features:["100% Organic","Ready to Use","Nutrient Rich"],description:"Premium organic potting mix perfect for indoor and outdoor plants. Enriched with natural nutrients."},{name:"Ceramic Planter - White",category:"Pots & Planters",subcategory:"Ceramic Pots",price:799,originalPrice:999,rating:4.4,reviews:123,image:"",badge:"Trending",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Drainage Holes","Modern Design","Weather Resistant"],description:"Elegant white ceramic planter with drainage holes. Perfect for indoor and covered outdoor spaces."},{name:"Sunflower Seeds - Premium Mix",category:"Seeds",subcategory:"Flower Seeds",price:149,originalPrice:199,rating:4.6,reviews:89,image:"",badge:"Flower Seeds",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Fast Germination","High Yield","Disease Resistant"],description:"Premium sunflower seed mix for beautiful garden blooms. Easy to grow and perfect for beginners."},{name:"Organic Tomato Seeds - Cherry Variety",category:"Seeds",subcategory:"Vegetable Seeds",price:99,originalPrice:129,rating:4.8,reviews:156,image:"",badge:"Vegetable Seeds",badgeColor:"bg-green-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Organic Certified","Sweet Flavor","High Yield"],description:"Organic cherry tomato seeds that produce sweet, juicy fruits. Perfect for containers and gardens."},{name:"Basil Seeds - Sweet Genovese",category:"Seeds",subcategory:"Herb Seeds",price:79,originalPrice:99,rating:4.7,reviews:234,image:"",badge:"Herb Seeds",badgeColor:"bg-emerald-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Aromatic","Fast Growing","Culinary Use"],description:"Classic Genovese basil seeds for aromatic herbs. Essential for Italian cooking and pesto making."},{name:"Lawn Grass Seeds - Bermuda Mix",category:"Seeds",subcategory:"Grass Seeds",price:299,originalPrice:399,rating:4.5,reviews:67,image:"",badge:"Grass Seeds",badgeColor:"bg-lime-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Drought Resistant","Low Maintenance","Dense Growth"],description:"Premium Bermuda grass seed mix for lush, green lawns. Perfect for warm climates and high-traffic areas."},{name:"Exotic Orchid Seeds - Phalaenopsis",category:"Seeds",subcategory:"Exotic Seeds",price:599,originalPrice:799,rating:4.9,reviews:45,image:"",badge:"Exotic Seeds",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Rare Variety","Beautiful Blooms","Collector Item"],description:"Rare Phalaenopsis orchid seeds for exotic flower enthusiasts. Requires special care but produces stunning blooms."},{name:"Ceramic Planter - Modern White",category:"Pots & Planters",subcategory:"Ceramic Pots",price:899,originalPrice:1199,rating:4.7,reviews:189,image:"",badge:"Ceramic Pots",badgeColor:"bg-blue-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Drainage Holes","Modern Design","Weather Resistant"],description:"Elegant white ceramic planter with drainage holes. Perfect for indoor and covered outdoor spaces."},{name:"Hanging Planter - Macrame Style",category:"Pots & Planters",subcategory:"Hanging Planters",price:649,originalPrice:849,rating:4.6,reviews:234,image:"",badge:"Hanging Planters",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Macrame Design","Adjustable Length","Indoor Use"],description:"Beautiful macrame hanging planter perfect for trailing plants. Adds bohemian charm to any space."},{name:"Self-Watering Planter - Smart Pot",category:"Pots & Planters",subcategory:"Self-Watering",price:1299,originalPrice:1599,rating:4.8,reviews:156,image:"",badge:"Self-Watering",badgeColor:"bg-teal-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Water Reservoir","Moisture Indicator","Overflow Protection"],description:"Smart self-watering planter with built-in water reservoir. Perfect for busy plant parents."},{name:"Terracotta Pot - Classic Round",category:"Pots & Planters",subcategory:"Terracotta Pots",price:299,originalPrice:399,rating:4.5,reviews:445,image:"",badge:"Terracotta Pots",badgeColor:"bg-orange-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Natural Material","Breathable","Classic Design"],description:"Classic terracotta pot made from natural clay. Excellent for root health and moisture regulation."},{name:"Decorative Planter - Geometric Pattern",category:"Pots & Planters",subcategory:"Decorative Pots",price:799,originalPrice:999,rating:4.4,reviews:123,image:"",badge:"Decorative Pots",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Geometric Design","Modern Aesthetic","Statement Piece"],description:"Stunning geometric planter that doubles as home decor. Perfect for showcasing your favorite plants."}].map(e=>m(e));return await Promise.all(e),!0}catch(e){return!1}},V=async(e,t="images")=>{try{let a=Date.now(),r=`${a}_${e.name}`,i=(0,n.iH)(d,`${t}/${r}`),o=await (0,n.KV)(i,e);return await (0,n.Jt)(o.ref)}catch(e){throw Error("Failed to upload image. Please try again.")}},W=e=>["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type)?e.size>5242880?{isValid:!1,error:"Image size must be less than 5MB"}:{isValid:!0}:{isValid:!1,error:"Please select a valid image file (JPEG, PNG, WebP, or GIF)"},X=(e,t=800,a=.8)=>new Promise(r=>{let i=document.createElement("canvas"),o=i.getContext("2d"),n=new Image;n.onload=()=>{let s=Math.min(t/n.width,t/n.height);i.width=n.width*s,i.height=n.height*s,o?.drawImage(n,0,0,i.width,i.height),i.toBlob(t=>{t?r(new File([t],e.name,{type:e.type,lastModified:Date.now()})):r(e)},e.type,a)},n.src=URL.createObjectURL(e)}),j=()=>null,_=()=>{},$=()=>null!==j(),K=async()=>{try{return(await (0,o.PL)((0,o.hJ)(l,"searchSuggestions"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return[]}},Y=async()=>{try{return(await (0,o.PL)((0,o.hJ)(l,"recentSearches"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return[]}},N=async()=>{try{return(await (0,o.PL)((0,o.hJ)(l,"trendingSearches"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return[]}},Z=async e=>{try{let t=await h(),a=e.toLowerCase();return t.filter(e=>{let t=e.name?.toLowerCase()||"",r=e.category?.toLowerCase()||"",i=e.subcategory?.toLowerCase()||"",o=e.description?.toLowerCase()||"",n=e.features?.join(" ").toLowerCase()||"";return t.includes(a)||r.includes(a)||i.includes(a)||o.includes(a)||n.includes(a)})}catch(e){return[]}},Q=async e=>{try{let t=(await Y()).find(t=>t.term===e);t?await (0,o.r7)((0,o.JU)(l,"recentSearches",t.id),{timestamp:new Date}):await (0,o.ET)((0,o.hJ)(l,"recentSearches"),{term:e,timestamp:new Date})}catch(e){}},ee=async()=>{try{let e=[{term:"monstera plant",timestamp:new Date(Date.now()-72e5)},{term:"gardening tools",timestamp:new Date(Date.now()-864e5)},{term:"organic soil",timestamp:new Date(Date.now()-1728e5)},{term:"flower seeds",timestamp:new Date(Date.now()-2592e5)},{term:"plant pots",timestamp:new Date(Date.now()-432e6)}];for(let e of[{term:"monstera plant",type:"product",category:"Indoor Plants"},{term:"snake plant",type:"product",category:"Indoor Plants"},{term:"gardening tools",type:"category",category:"Tools"},{term:"organic soil",type:"product",category:"Soil & Fertilizer"},{term:"flower seeds",type:"product",category:"Seeds"},{term:"plant pots",type:"product",category:"Pots & Planters"},{term:"fertilizer",type:"category",category:"Soil & Fertilizer"},{term:"succulents",type:"product",category:"Indoor Plants"},{term:"air purifying plants",type:"product",category:"Indoor Plants"},{term:"herb garden",type:"category",category:"Seeds"},{term:"bonsai trees",type:"product",category:"Outdoor Plants"},{term:"vertical garden",type:"category",category:"Tools"}])await (0,o.ET)((0,o.hJ)(l,"searchSuggestions"),e);for(let t of e)await (0,o.ET)((0,o.hJ)(l,"recentSearches"),t);for(let e of[{term:"succulents",count:156,trend:"up"},{term:"air purifying plants",count:134,trend:"up"},{term:"herb garden",count:98,trend:"up"},{term:"bonsai trees",count:87,trend:"stable"},{term:"vertical garden",count:76,trend:"up"}])await (0,o.ET)((0,o.hJ)(l,"trendingSearches"),e);return!0}catch(e){return!1}},et=async(e,t,a)=>{try{(await a.confirm(t)).user;let r=(0,o.hJ)(l,"riders"),i=(0,o.IO)(r,(0,o.ar)("phone","==",e)),n=await (0,o.PL)(i);if(n.empty)throw Error("Rider not found. Please contact admin for registration.");let s=n.docs[0],c={id:s.id,...s.data()};if(!c.isActive)throw Error("Rider account is deactivated. Please contact admin.");return await (0,o.r7)(s.ref,{lastActiveAt:new Date,status:"online"}),c}catch(e){throw e}},ea=async e=>{try{return(await (0,o.ET)((0,o.hJ)(l,"riders"),{...e,status:"offline",currentLocation:null,currentOrderId:null,totalDeliveries:0,completedDeliveries:0,cancelledDeliveries:0,rating:5,totalEarnings:0,isActive:!0,isVerified:!1,performance:{avgDeliveryTime:0,onTimeDeliveryRate:100,customerRating:5},createdAt:new Date,lastLocationUpdate:null,lastActiveAt:null})).id}catch(e){throw e}},er=async()=>{try{let e=(0,o.hJ)(l,"riders"),t=(0,o.IO)(e,(0,o.Xo)("createdAt","desc"));return(await (0,o.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw e}},ei=e=>{let t=(0,o.hJ)(l,"riders"),a=(0,o.IO)(t,(0,o.Xo)("createdAt","desc"));return(0,o.cf)(a,t=>{e(t.docs.map(e=>({id:e.id,...e.data()})))})},eo=async(e,t)=>{try{let a=(0,o.JU)(l,"riders",e);await (0,o.r7)(a,{status:t,lastActiveAt:new Date})}catch(e){throw e}},en=async(e,t)=>{try{let a=(0,o.JU)(l,"riders",e);await (0,o.r7)(a,{currentLocation:{...t,accuracy:10,timestamp:new Date},lastLocationUpdate:new Date})}catch(e){throw e}},es=async(e,t)=>{try{let a=(0,o.qs)(l),r=(0,o.JU)(l,"orders",e);a.update(r,{riderId:t,status:"assigned",riderAssignedAt:new Date,updatedAt:new Date});let i=(0,o.JU)(l,"riders",t);a.update(i,{status:"busy",currentOrderId:e,lastActiveAt:new Date});let n=(0,o.JU)((0,o.hJ)(l,"order_tracking"));return a.set(n,{orderId:e,riderId:t,status:"assigned",customerLocation:null,riderLocation:null,estimatedArrival:null,actualDistance:null,estimatedDistance:null,route:[],trackingEvents:[{event:"order_assigned",timestamp:new Date,location:null,note:"Order assigned to rider"}],createdAt:new Date,updatedAt:new Date}),await a.commit(),n.id}catch(e){throw e}},ec=async(e,t,a)=>{try{let r=(0,o.qs)(l),i=(0,o.JU)(l,"orders",e),n={status:t,updatedAt:new Date};switch(t){case"picked_up":n.pickedUpAt=new Date;break;case"out_for_delivery":n.outForDeliveryAt=new Date;break;case"delivered":n.deliveredAt=new Date,n.actualDeliveryTime=new Date,a?.deliveryProof&&(n.deliveryProof=a.deliveryProof)}r.update(i,n);let s=(0,o.IO)((0,o.hJ)(l,"order_tracking"),(0,o.ar)("orderId","==",e)),c=await (0,o.PL)(s);if(!c.empty){let e=c.docs[0],i=e.data().trackingEvents||[];r.update(e.ref,{status:t,trackingEvents:[...i,{event:t,timestamp:new Date,location:a?.location||null,note:a?.note||`Order ${t.replace("_"," ")}`}],updatedAt:new Date})}if("delivered"===t){let t=await P(e);if(t?.riderId){let e=(0,o.JU)(l,"riders",t.riderId);r.update(e,{status:"online",currentOrderId:null,completedDeliveries:(0,o.nP)(1),totalDeliveries:(0,o.nP)(1),lastActiveAt:new Date})}}await r.commit()}catch(e){throw e}},el=(e,t)=>{let a=(0,o.hJ)(l,"order_tracking"),r=(0,o.IO)(a,(0,o.ar)("orderId","==",e));return(0,o.cf)(r,e=>{if(e.empty)t(null);else{let a=e.docs[0];t({id:a.id,...a.data()})}})},ed=()=>null,eg=e=>{},eu=()=>null!==ed(),em=(e,t)=>{let a=(0,o.hJ)(l,"orders"),r=(0,o.IO)(a,(0,o.ar)("riderId","==",e),(0,o.ar)("status","in",["assigned","picked_up","out_for_delivery"]),(0,o.Xo)("createdAt","desc"));return(0,o.cf)(r,e=>{t(e.docs.map(e=>({id:e.id,...e.data()})))})}}};