(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9801],{5883:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(2898).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},2245:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(2898).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},7972:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(2898).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},3178:function(e,t,s){Promise.resolve().then(s.bind(s,4404))},4404:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var n=s(6687),r=s(5029),a=s(8965),i=s(4670),l=s(44),o=s(7437),c=s(2265),d=s(4033),u=s(7972),m=s(5883),x=s(4322),f=s(3008);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,s(2898).Z)("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);var g=s(2245),p=s(2741),y=s(2682),v=s(286),b=s(4499),j=s(5853),N=function(){var e,t,s,N,w,_=(0,d.useRouter)(),k=(0,i._)((0,c.useState)(null),2),O=k[0],S=k[1],C=(0,i._)((0,c.useState)(null),2),T=C[0],R=C[1],Z=(0,i._)((0,c.useState)([]),2),E=Z[0],P=Z[1],D=(0,i._)((0,c.useState)(null),2),I=D[0],L=D[1],A=(0,i._)((0,c.useState)({totalDeliveries:0,completedToday:0,earnings:0,rating:5}),2),z=A[0];A[1];var M=(0,i._)((0,c.useState)(!1),2),U=M[0],G=M[1],H=(0,i._)((0,c.useState)(null),2),J=H[0],Y=H[1],q=(0,i._)((0,c.useState)(!0),2),W=q[0],F=q[1],V=(0,c.useRef)(null),$=(0,j.useToast)().showToast,B=(0,c.useRef)(null);(0,c.useEffect)(function(){if(!(0,b.isRiderLoggedIn)()){_.push("/rider/auth/login");return}var e,t=(0,b.getCurrentRider)();return S(t),G((null==t?void 0:t.status)==="online"),(null==t?void 0:t.id)?e=(0,b.subscribeToRiderOrders)(t.id,function(e){var t=e.find(function(e){return["assigned","picked_up","out_for_delivery"].includes(e.status)}),s=e.filter(function(e){return!["assigned","picked_up","out_for_delivery"].includes(e.status)}).slice(0,10);R(t||null),P(s),t?(0,b.subscribeToOrderTracking)(t.id,function(e){L(e)}):L(null),F(!1)}):F(!1),function(){e&&e()}},[_]),(0,c.useEffect)(function(){return U?navigator.geolocation?(navigator.geolocation.getCurrentPosition(function(e){Q({lat:e.coords.latitude,lng:e.coords.longitude})},function(e){alert("Location permission is required for delivery tracking. Please enable location services.")},{enableHighAccuracy:!0}),V.current=setInterval(function(){navigator.geolocation.getCurrentPosition(function(e){Q({lat:e.coords.latitude,lng:e.coords.longitude})})},1e4)):alert("Geolocation is not supported by your browser."):V.current&&(clearInterval(V.current),V.current=null),function(){V.current&&(clearInterval(V.current),V.current=null)}},[U]),(0,c.useEffect)(function(){T&&T.status&&(B.current&&B.current!==T.status&&$("Order status updated: ".concat(T.status.replace("_"," ")),"info"),B.current=T.status)},[null==T?void 0:T.status]);var K=(e=(0,n._)(function(){var e,t;return(0,l.Jh)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=U?"offline":"online",[4,(0,b.updateRiderStatus)(O.id,e)];case 1:return s.sent(),G(!U),S(t=(0,a._)((0,r._)({},O),{status:e})),localStorage.setItem("currentRider",JSON.stringify(t)),[3,3];case 2:return s.sent(),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)}),Q=(t=(0,n._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(Y(e),!(null==O?void 0:O.id))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,b.updateRiderLocation)(O.id,e)];case 2:case 3:return t.sent(),[3,4];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),X=(s=(0,n._)(function(e){var t;return(0,l.Jh)(this,function(s){switch(s.label){case 0:if(!T||!(null==O?void 0:O.id))return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),t={location:J,note:"Order ".concat(e.replace("_"," ")," by rider")},"delivered"===e&&(t.deliveryProof={type:"photo",url:"placeholder-proof-url",timestamp:new Date}),[4,(0,b.updateOrderStatusWithRider)(T.id,e,t)];case 2:case 3:return s.sent(),[3,4];case 4:return[2]}})}),function(e){return s.apply(this,arguments)}),ee=function(){var e;if(null==T?void 0:null===(e=T.address)||void 0===e?void 0:e.coordinates){var t=T.address.coordinates,s=t.lat,n=t.lng,r="https://www.google.com/maps/dir/?api=1&destination=".concat(s,",").concat(n,"&travelmode=driving");window.open(r,"_blank")}};return W?(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):(0,o.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,o.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,o.jsx)("div",{className:"max-w-md mx-auto px-4 py-4",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:(0,o.jsx)(u.Z,{className:"w-6 h-6 text-green-600"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"font-semibold text-gray-900",children:null==O?void 0:O.name}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:null==O?void 0:O.vehicle})]})]}),(0,o.jsx)("button",{onClick:function(){localStorage.removeItem("currentRider"),_.push("/rider/auth/login")},className:"p-2 text-gray-400 hover:text-gray-600",children:(0,o.jsx)(m.Z,{className:"w-5 h-5"})})]})})}),(0,o.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:[(0,o.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(U?"bg-green-500":"bg-gray-400")}),(0,o.jsx)("span",{className:"font-medium text-gray-900",children:U?"You are Online":"You are Offline"})]}),(0,o.jsx)("button",{onClick:K,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(U?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),children:U?"Go Offline":"Go Online"})]})}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,o.jsx)(x.Z,{className:"w-5 h-5 text-blue-600"}),(0,o.jsx)("span",{className:"text-sm text-gray-600",children:"Total Orders"})]}),(0,o.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:z.totalDeliveries})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,o.jsx)(f.Z,{className:"w-5 h-5 text-green-600"}),(0,o.jsx)("span",{className:"text-sm text-gray-600",children:"Today"})]}),(0,o.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:z.completedToday})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,o.jsx)(h,{className:"w-5 h-5 text-purple-600"}),(0,o.jsx)("span",{className:"text-sm text-gray-600",children:"Earnings"})]}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["â‚¹",z.earnings]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,o.jsx)(g.Z,{className:"w-5 h-5 text-yellow-600"}),(0,o.jsx)("span",{className:"text-sm text-gray-600",children:"Rating"})]}),(0,o.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:z.rating})]})]}),T?(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,o.jsxs)("div",{className:"p-4 border-b",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("h2",{className:"font-semibold text-gray-900",children:"Active Order"}),(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("assigned"===T.status?"bg-blue-100 text-blue-700":"picked_up"===T.status?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"),children:T.status.replace("_"," ").toUpperCase()})]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["#",T.orderNumber]})]}),(0,o.jsxs)("div",{className:"p-4 space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"font-medium text-gray-900",children:T.customerName||"Customer"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:(null===(N=T.address)||void 0===N?void 0:N.street)||"Address not available"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:(null===(w=T.address)||void 0===w?void 0:w.city)||""})]}),(0,o.jsx)("button",{onClick:function(){return window.open("tel:".concat(T.customerPhone))},className:"p-2 bg-green-100 text-green-600 rounded-full hover:bg-green-200",children:(0,o.jsx)(p.Z,{className:"w-5 h-5"})})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Items (",T.items.length,")"]}),T.items.slice(0,3).map(function(e,t){var s=e.quantity||e.qty||1;return(0,o.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,o.jsxs)("span",{className:"text-gray-600",children:[s,"x ",e.name]}),(0,o.jsxs)("span",{className:"text-gray-900",children:["â‚¹",e.price*s]})]},t)}),T.items.length>3&&(0,o.jsxs)("p",{className:"text-sm text-gray-500",children:["+",T.items.length-3," more items"]}),(0,o.jsxs)("div",{className:"border-t pt-2 flex justify-between font-medium",children:[(0,o.jsx)("span",{children:"Total Amount"}),(0,o.jsxs)("span",{children:["â‚¹",T.totalAmount||T.total||0]})]})]}),I&&(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)("h3",{className:"font-medium text-gray-900",children:"Live Tracking"}),(0,o.jsx)(v.Z,{orderId:T.id,trackingData:I,mode:"rider",height:"200px",onLocationUpdate:Q,onDirectionsClick:ee})]}),(0,o.jsxs)("div",{className:"space-y-2",children:["assigned"===T.status&&(0,o.jsx)("button",{onClick:function(){return X("picked_up")},className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700",children:"Mark as Picked Up"}),"picked_up"===T.status&&(0,o.jsx)("button",{onClick:function(){return X("out_for_delivery")},className:"w-full bg-orange-600 text-white py-3 rounded-lg font-medium hover:bg-orange-700",children:"Start Delivery"}),"out_for_delivery"===T.status&&(0,o.jsx)("button",{onClick:function(){return X("delivered")},className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700",children:"Mark as Delivered"}),(0,o.jsxs)("button",{onClick:ee,className:"w-full bg-gray-100 text-gray-700 py-3 rounded-lg font-medium hover:bg-gray-200 flex items-center justify-center gap-2",children:[(0,o.jsx)(y.Z,{className:"w-5 h-5"}),"Open in Maps"]})]})]})]}):(0,o.jsxs)("div",{className:"bg-white rounded-lg p-8 text-center shadow-sm",children:[(0,o.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,o.jsx)(x.Z,{className:"w-8 h-8 text-gray-400"})}),(0,o.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"No Active Orders"}),(0,o.jsx)("p",{className:"text-gray-600 text-sm",children:U?"You'll receive new orders when available":"Go online to start receiving orders"})]}),E.length>0&&(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,o.jsx)("div",{className:"p-4 border-b",children:(0,o.jsx)("h2",{className:"font-semibold text-gray-900",children:"Recent Orders"})}),(0,o.jsx)("div",{className:"divide-y",children:E.map(function(e){return(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsxs)("span",{className:"font-medium text-gray-900",children:["#",e.orderNumber]}),(0,o.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("delivered"===e.status?"bg-green-100 text-green-700":"cancelled"===e.status?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.status.toUpperCase()})]}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:e.customerName}),(0,o.jsxs)("p",{className:"text-sm text-gray-600",children:["â‚¹",e.totalAmount]}),(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleDateString()})]},e.id)})})]})]})]})}},5853:function(e,t,s){"use strict";s.r(t),s.d(t,{ToastProvider:function(){return u},useToast:function(){return d}});var n=s(4670),r=s(1801),a=s(7437),i=s(9102),l=s.n(i),o=s(2265),c=(0,o.createContext)({showToast:function(){}}),d=function(){return(0,o.useContext)(c)},u=function(e){var t=e.children,s=(0,n._)((0,o.useState)([]),2),i=s[0],d=s[1];return(0,a.jsxs)(c.Provider,{value:{showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=Date.now();d(function(n){return(0,r._)(n).concat([{id:s,message:e,type:t}])}),setTimeout(function(){d(function(e){return e.filter(function(e){return e.id!==s})})},3500)}},children:[t,(0,a.jsx)("div",{className:"jsx-8325a2722a98286e fixed top-4 right-4 z-50 space-y-2",children:i.map(function(e){return(0,a.jsx)("div",{className:"jsx-8325a2722a98286e "+"px-4 py-3 rounded-lg shadow-lg text-white font-medium transition-all animate-fade-in-down\n              ".concat("success"===e.type?"bg-green-600":"error"===e.type?"bg-red-600":"bg-gray-800"),children:e.message},e.id)})}),(0,a.jsx)(l(),{id:"8325a2722a98286e",children:"@-webkit-keyframes fade-in-down{0%{opacity:0;-webkit-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fade-in-down{0%{opacity:0;-moz-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fade-in-down{0%{opacity:0;-o-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fade-in-down{0%{opacity:0;-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-fade-in-down{-webkit-animation:fade-in-down.4s ease;-moz-animation:fade-in-down.4s ease;-o-animation:fade-in-down.4s ease;animation:fade-in-down.4s ease}"})]})}},622:function(e,t,s){"use strict";var n=s(2265),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var n,a={},c=null,d=null;for(n in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,n)&&!o.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:r,type:e,key:c,ref:d,props:a,_owner:l.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[4358,9990,5643,6225,4499,286,2971,4938,1744],function(){return e(e.s=3178)}),_N_E=e.O()}]);