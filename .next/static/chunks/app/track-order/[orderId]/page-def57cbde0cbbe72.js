(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7998],{6392:function(e,s,t){Promise.resolve().then(t.bind(t,9695))},9695:function(e,s,t){"use strict";t.r(s);var r=t(6687),a=t(4670),n=t(44),i=t(7437),l=t(2265),c=t(4033),d=t(6141),o=t(4322),m=t(1961),u=t(3008),x=t(3067),h=t(4280),f=t(2245),g=t(2741),p=t(2176),y=t(6142),j=t(286),v=t(4499),b=t(5853);s.default=function(){var e,s,t,N,w,k=(0,c.useParams)(),T=(0,c.useRouter)(),_=k.orderId,Z=(0,a._)((0,l.useState)(null),2),D=Z[0],C=Z[1],O=(0,a._)((0,l.useState)(null),2),S=O[0],E=O[1],I=(0,a._)((0,l.useState)(null),2),z=I[0],A=I[1],P=(0,a._)((0,l.useState)(!0),2),L=P[0],Y=P[1],R=(0,a._)((0,l.useState)(""),2),J=R[0],q=R[1],F=(0,a._)((0,l.useState)(!1),2),H=F[0],G=F[1],Q=(0,b.useToast)().showToast,U=l.useRef(null);(0,l.useEffect)(function(){if(_){B();var e=(0,v.subscribeToOrderTracking)(_,function(e){e&&(E(e),e.riderId&&!z&&K(e.riderId))});return function(){return e()}}},[_]),(0,l.useEffect)(function(){S&&S.status&&(U.current&&U.current!==S.status&&Q("Order status updated: ".concat(S.status.replace("_"," ")),"info"),U.current=S.status)},[null==S?void 0:S.status]);var B=(e=(0,r._)(function(){var e;return(0,n.Jh)(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),Y(!0),[4,(0,v.getOrder)(_)];case 1:if(!(e=s.sent()))return q("Order not found"),Y(!1),[2];if(C(e),!e.riderId)return[3,3];return[4,K(e.riderId)];case 2:s.sent(),s.label=3;case 3:return Y(!1),[3,5];case 4:return s.sent(),q("Failed to load order details"),Y(!1),[3,5];case 5:return[2]}})}),function(){return e.apply(this,arguments)}),K=(s=(0,r._)(function(e){var s;return(0,n.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,v.getRiders)()];case 1:return(s=t.sent().find(function(s){return s.id===e}))&&A({id:s.id,name:s.name,phone:s.phone,vehicleType:s.vehicleType,vehicleNumber:s.vehicleNumber,rating:s.rating}),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}})}),function(e){return s.apply(this,arguments)}),M=(t=(0,r._)(function(){return(0,n.Jh)(this,function(e){switch(e.label){case 0:return G(!0),[4,B()];case 1:return e.sent(),G(!1),[2]}})}),function(){return t.apply(this,arguments)});if(L)return(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Loading order details..."})]})});if(J)return(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,i.jsx)(o.Z,{className:"w-8 h-8 text-red-600"})}),(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Order Not Found"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:J}),(0,i.jsx)("button",{onClick:function(){return T.push("/")},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700",children:"Go Home"})]})});if(!D)return null;var V=function(e){switch(e){case"pending":return{color:"text-yellow-600 bg-yellow-100",icon:(0,i.jsx)(d.Z,{className:"w-5 h-5"}),title:"Order Confirmed",description:"Your order is being prepared"};case"assigned":return{color:"text-blue-600 bg-blue-100",icon:(0,i.jsx)(o.Z,{className:"w-5 h-5"}),title:"Rider Assigned",description:"A delivery partner has been assigned"};case"picked_up":return{color:"text-orange-600 bg-orange-100",icon:(0,i.jsx)(o.Z,{className:"w-5 h-5"}),title:"Order Picked Up",description:"Your order has been picked up"};case"out_for_delivery":return{color:"text-green-600 bg-green-100",icon:(0,i.jsx)(m.Z,{className:"w-5 h-5"}),title:"Out for Delivery",description:"Your order is on the way"};case"delivered":return{color:"text-purple-600 bg-purple-100",icon:(0,i.jsx)(u.Z,{className:"w-5 h-5"}),title:"Delivered",description:"Your order has been delivered successfully"};default:return{color:"text-gray-600 bg-gray-100",icon:(0,i.jsx)(d.Z,{className:"w-5 h-5"}),title:"Processing",description:"Your order is being processed"}}}(D.status);return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,i.jsx)("div",{className:"max-w-md mx-auto px-4 py-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("button",{onClick:function(){return T.back()},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg",children:(0,i.jsx)(x.Z,{className:"w-5 h-5"})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h1",{className:"font-semibold text-gray-900",children:"Track Order"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["#",D.orderNumber||D.id]})]}),(0,i.jsx)("button",{onClick:M,disabled:H,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg disabled:opacity-50",children:(0,i.jsx)(h.Z,{className:"w-5 h-5 ".concat(H?"animate-spin":"")})})]})})}),(0,i.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:[(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,i.jsx)("div",{className:"p-2 rounded-full ".concat(V.color),children:V.icon}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h2",{className:"font-semibold text-gray-900",children:V.title}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:V.description})]})]}),(0,i.jsx)("div",{className:"text-sm text-gray-600",children:(0,i.jsx)("p",{children:(null==D?void 0:D.actualDeliveryTime)?"Delivered at ".concat(new Date(D.actualDeliveryTime).toLocaleTimeString()):(null==S?void 0:S.estimatedArrival)?"Estimated arrival: ".concat(new Date(S.estimatedArrival).toLocaleTimeString()):(null==D?void 0:D.estimatedDeliveryTime)?"Estimated delivery: ".concat(new Date(D.estimatedDeliveryTime).toLocaleTimeString()):"Calculating delivery time..."})})]}),S&&z&&(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,i.jsx)("div",{className:"p-4 border-b",children:(0,i.jsx)("h3",{className:"font-semibold text-gray-900",children:"Live Tracking"})}),(0,i.jsx)(j.Z,{orderId:_,trackingData:S,mode:"customer",height:"300px",riderInfo:{name:z.name,phone:z.phone,vehicle:"".concat(z.vehicleType," - ").concat(z.vehicleNumber),rating:z.rating}})]}),z&&"pending"!==D.status&&(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Your Delivery Partner"}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,i.jsx)(m.Z,{className:"w-6 h-6 text-green-600"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:z.name}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:[z.vehicleType," - ",z.vehicleNumber]}),(0,i.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,i.jsx)(f.Z,{className:"w-4 h-4 text-yellow-400 fill-current"}),(0,i.jsx)("span",{className:"text-sm text-gray-600",children:z.rating})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:function(){return window.open("tel:".concat(z.phone))},className:"p-3 bg-green-100 text-green-600 rounded-full hover:bg-green-200",children:(0,i.jsx)(g.Z,{className:"w-5 h-5"})}),(0,i.jsx)("button",{onClick:function(){return window.open("sms:".concat(z.phone))},className:"p-3 bg-blue-100 text-blue-600 rounded-full hover:bg-blue-200",children:(0,i.jsx)(p.Z,{className:"w-5 h-5"})})]})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,i.jsx)("div",{className:"p-4 border-b",children:(0,i.jsx)("h3",{className:"font-semibold text-gray-900",children:"Order Items"})}),(0,i.jsxs)("div",{className:"p-4 space-y-3",children:[D.items.map(function(e,s){var t=e.quantity||e.qty||1;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[e.image?(0,i.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 rounded-lg object-cover"}):(0,i.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,i.jsx)(o.Z,{className:"w-6 h-6 text-gray-400"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Qty: ",t]})]})]}),(0,i.jsxs)("p",{className:"font-medium text-gray-900",children:["₹",e.price*t]})]},s)}),(0,i.jsxs)("div",{className:"border-t pt-3 flex justify-between font-semibold text-gray-900",children:[(0,i.jsx)("span",{children:"Total Amount"}),(0,i.jsxs)("span",{children:["₹",D.totalAmount||D.total||0]})]})]})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Delivery Address"}),(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(0,i.jsx)(y.Z,{className:"w-5 h-5 text-gray-400 mt-1"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-gray-900",children:(null===(N=D.address)||void 0===N?void 0:N.street)||"Address not available"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:(null===(w=D.address)||void 0===w?void 0:w.city)||""})]})]})]}),S&&S.trackingEvents.length>0&&(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,i.jsx)("div",{className:"p-4 border-b",children:(0,i.jsx)("h3",{className:"font-semibold text-gray-900",children:"Order Timeline"})}),(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)("div",{className:"space-y-4",children:S.trackingEvents.map(function(e,s){return(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full mt-2"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("p",{className:"font-medium text-gray-900 capitalize",children:e.event.replace("_"," ")}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:e.note}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleString()})]})]},s)})})})]}),(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,i.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Need Help?"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("button",{className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"text-gray-900",children:"Contact Customer Support"}),(0,i.jsx)(g.Z,{className:"w-4 h-4 text-gray-400"})]})}),(0,i.jsx)("button",{className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"text-gray-900",children:"Report an Issue"}),(0,i.jsx)(p.Z,{className:"w-4 h-4 text-gray-400"})]})})]})]})]})]})}},5853:function(e,s,t){"use strict";t.r(s),t.d(s,{ToastProvider:function(){return m},useToast:function(){return o}});var r=t(4670),a=t(1801),n=t(7437),i=t(9102),l=t.n(i),c=t(2265),d=(0,c.createContext)({showToast:function(){}}),o=function(){return(0,c.useContext)(d)},m=function(e){var s=e.children,t=(0,r._)((0,c.useState)([]),2),i=t[0],o=t[1];return(0,n.jsxs)(d.Provider,{value:{showToast:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=Date.now();o(function(r){return(0,a._)(r).concat([{id:t,message:e,type:s}])}),setTimeout(function(){o(function(e){return e.filter(function(e){return e.id!==t})})},3500)}},children:[s,(0,n.jsx)("div",{className:"jsx-8325a2722a98286e fixed top-4 right-4 z-50 space-y-2",children:i.map(function(e){return(0,n.jsx)("div",{className:"jsx-8325a2722a98286e "+"px-4 py-3 rounded-lg shadow-lg text-white font-medium transition-all animate-fade-in-down\n              ".concat("success"===e.type?"bg-green-600":"error"===e.type?"bg-red-600":"bg-gray-800"),children:e.message},e.id)})}),(0,n.jsx)(l(),{id:"8325a2722a98286e",children:"@-webkit-keyframes fade-in-down{0%{opacity:0;-webkit-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fade-in-down{0%{opacity:0;-moz-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fade-in-down{0%{opacity:0;-o-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fade-in-down{0%{opacity:0;-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px)}100%{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-fade-in-down{-webkit-animation:fade-in-down.4s ease;-moz-animation:fade-in-down.4s ease;-o-animation:fade-in-down.4s ease;animation:fade-in-down.4s ease}"})]})}}},function(e){e.O(0,[4358,9990,5643,6569,8281,4499,286,2971,4938,1744],function(){return e(e.s=6392)}),_N_E=e.O()}]);