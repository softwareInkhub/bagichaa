"use strict";exports.id=27,exports.ids=[27],exports.modules={37027:(e,t,s)=>{s.d(t,{Z:()=>x});var r=s(95344),a=s(3729),n=s(91917),l=s(16278),i=s(27860),o=s(7060),c=s(25545),d=s(80508),u=s(42739),m=s(40626),g=s(4377);let x=({orderId:e,trackingData:t,mode:s,height:x="400px",showControls:h=!0,showRoute:p=!0,onLocationUpdate:w,onDirectionsClick:f,riderInfo:v,customerAddress:b})=>{let j=(0,a.useRef)(null),N=(0,a.useRef)(null),y=(0,a.useRef)(null),k=(0,a.useRef)(null),L=(0,a.useRef)(null),C=(0,a.useRef)(null),Z=(0,a.useRef)(null),[M,D]=(0,a.useState)(!0),[S,A]=(0,a.useState)(null),[R,z]=(0,a.useState)(null),[I,T]=(0,a.useState)(!1),[$,_]=(0,a.useState)(!1),[E,B]=(0,a.useState)(null),[F,O]=(0,a.useState)(null),P=(0,a.useCallback)(()=>{if(!N.current){if(!j.current||!window.google){A("Map container not available");return}try{let e={zoom:14,center:{lat:28.6139,lng:77.209},mapTypeControl:!1,streetViewControl:!1,fullscreenControl:"admin"===s};e.mapId="377229b98af3c169e073c4d1",N.current=new window.google.maps.Map(j.current,e),L.current=new window.google.maps.DirectionsService,C.current=new window.google.maps.DirectionsRenderer({suppressMarkers:!0,polylineOptions:{strokeColor:"#10B981",strokeWeight:4,strokeOpacity:.8}}),C.current.setMap(N.current),D(!1),"rider"===s&&W(),t&&X(t)}catch(e){A("Failed to initialize map"),D(!1)}}},[s,t]),V=(0,a.useCallback)(()=>{new g.aN({apiKey:"AIzaSyDIHawXZZfiYMhBUznsnbXS0LOId9u5FLA",version:"weekly",libraries:["geometry","places","marker"]}).load().then(()=>{P()}).catch(()=>A("Failed to load Google Maps"))},[P]),W=(0,a.useCallback)(()=>{navigator.geolocation&&(T(!0),Z.current=navigator.geolocation.watchPosition(e=>{let t={lat:e.coords.latitude,lng:e.coords.longitude};z(t),w&&w(t),y.current?y.current.position=t:G(t),N.current&&N.current.setCenter(t)},e=>{T(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4}))},[w]);(0,a.useCallback)(()=>{Z.current&&(navigator.geolocation.clearWatch(Z.current),Z.current=null),T(!1)},[]);let G=(0,a.useCallback)(e=>{if(!N.current||!window.google||!e)return;y.current&&(y.current.map=null);let{AdvancedMarkerElement:t}=window.google.maps.marker;if(y.current=new t({map:N.current,position:e,title:"Delivery Partner",content:(()=>{let e=document.createElement("div");return e.innerHTML='<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="14" fill="#10B981" stroke="#ffffff" stroke-width="3"/><path d="M10 16L14 20L22 12" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',e})()}),v&&"rider"!==s){let e=new window.google.maps.InfoWindow({content:`
          <div class="p-3 min-w-[200px]">
            <div class="flex items-center gap-3 mb-2">
              <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                <svg width="20" height="20" fill="currentColor" class="text-green-600">
                  <path d="M8 16l2.879-2.879a3 3 0 114.242 4.242L8 24l-7.121-7.121a3 3 0 114.242-4.242L8 16z"/>
                </svg>
              </div>
              <div>
                <h4 class="font-semibold text-gray-900">${v.name}</h4>
                <p class="text-sm text-gray-600">${v.vehicle}</p>
              </div>
            </div>
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-1">
                <span class="text-yellow-400">⭐</span>
                <span class="text-sm font-medium">${v.rating}</span>
              </div>
              <button onclick="window.open('tel:${v.phone}')" 
                class="bg-green-600 text-white px-3 py-1 rounded-lg text-sm flex items-center gap-1">
                <svg width="14" height="14" fill="currentColor">
                  <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                </svg>
                Call
              </button>
            </div>
          </div>
        `});y.current.addListener("click",()=>{e.open(N.current,y.current)})}},[v,s]),H=(0,a.useCallback)(e=>{if(!N.current||!window.google||!e)return;k.current&&(k.current.map=null);let{AdvancedMarkerElement:t}=window.google.maps.marker;k.current=new t({map:N.current,position:e,title:"Delivery Address",content:(()=>{let e=document.createElement("div");return e.innerHTML='<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="14" fill="#EF4444" stroke="#ffffff" stroke-width="3"/><path d="M16 8v8l4 4" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',e})()})},[]),K=(0,a.useCallback)((e,t)=>{L.current&&C.current&&e&&t&&L.current.route({origin:e,destination:t,travelMode:window.google.maps.TravelMode.DRIVING,optimizeWaypoints:!0},(e,t)=>{"OK"===t&&C.current.setDirections(e)})},[]),X=(0,a.useCallback)(e=>{if(N.current&&(e.riderLocation&&G(e.riderLocation),e.customerLocation&&H(e.customerLocation),e.riderLocation&&e.customerLocation&&p&&K(e.riderLocation,e.customerLocation),e.riderLocation||e.customerLocation)){let t=new window.google.maps.LatLngBounds;e.riderLocation&&t.extend(e.riderLocation),e.customerLocation&&t.extend(e.customerLocation),N.current.fitBounds(t),window.google.maps.event.addListenerOnce(N.current,"bounds_changed",()=>{N.current.getZoom()>16&&N.current.setZoom(16)})}},[p,G,H,K]),U=async()=>{if(O(null),B(null),!window.google||!t?.riderLocation||!t?.customerLocation){O("Location data missing for navigation.");return}try{new window.google.maps.DirectionsService().route({origin:t.riderLocation,destination:t.customerLocation,travelMode:window.google.maps.TravelMode.DRIVING},(e,t)=>{if("OK"===t&&e){let t=e.routes[0].legs[0];B({eta:t.duration?.text||"N/A",distance:t.distance?.text||"N/A"})}else O("Could not calculate route. Please try again.")})}catch(e){O("Could not calculate route. Please try again.")}};return((0,a.useEffect)(()=>(j.current&&V(),()=>{Z.current&&navigator.geolocation.clearWatch(Z.current)}),[]),(0,a.useEffect)(()=>{t&&N.current&&X(t)},[t,X]),S)?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8 text-center",style:{height:x},children:[r.jsx("div",{className:"text-red-600 mb-2",children:r.jsx(d.Z,{className:"w-8 h-8 mx-auto"})}),r.jsx("p",{className:"text-red-700 font-medium",children:"Map Error"}),r.jsx("p",{className:"text-red-600 text-sm mt-1",children:S})]}):t&&(t.riderLocation||t.customerLocation)?(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{ref:j,className:"w-full rounded-lg border border-gray-200",style:{height:x}}),M&&r.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center rounded-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(u.Z,{className:"w-8 h-8 animate-spin text-green-600 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-600",children:"Loading map..."})]})}),h&&t&&r.jsx("div",{className:"absolute top-4 left-4 right-4 bg-white rounded-lg shadow-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-full ${(e=>{switch(e){case"assigned":return"text-blue-600 bg-blue-100";case"picked_up":return"text-orange-600 bg-orange-100";case"out_for_delivery":return"text-green-600 bg-green-100";case"delivered":return"text-purple-600 bg-purple-100";default:return"text-gray-600 bg-gray-100"}})(t.status)}`,children:(e=>{switch(e){case"assigned":return r.jsx(n.Z,{className:"w-4 h-4"});case"picked_up":return r.jsx(l.Z,{className:"w-4 h-4"});case"out_for_delivery":return r.jsx(i.Z,{className:"w-4 h-4"});case"delivered":return r.jsx(o.Z,{className:"w-4 h-4"});default:return r.jsx(c.Z,{className:"w-4 h-4"})}})(t.status)}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-semibold text-gray-900 capitalize",children:t.status.replace("_"," ")}),t.estimatedArrival&&(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["ETA: ",new Date(t.estimatedArrival).toLocaleTimeString()]})]})]}),"rider"===s&&(0,r.jsxs)("button",{onClick:()=>{_(!0),U()},className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-700 transition-colors",children:[r.jsx(i.Z,{className:"w-4 h-4"}),"Directions"]})]})}),"rider"===s&&$&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative",children:[r.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600",onClick:()=>_(!1),children:r.jsx("span",{className:"text-xl",children:"\xd7"})}),(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[r.jsx(i.Z,{className:"w-5 h-5"})," Directions"]}),(0,r.jsxs)("div",{className:"mb-2",children:[r.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Customer Address"}),r.jsx("div",{className:"text-sm text-gray-900 font-medium",children:b||"Address not available"})]}),F&&r.jsx("div",{className:"text-red-600 text-sm mb-2",children:F}),E?r.jsx("div",{className:"mb-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[r.jsx("span",{children:"ETA:"}),r.jsx("span",{className:"font-semibold",children:E.eta}),r.jsx("span",{children:"•"}),r.jsx("span",{children:"Distance:"}),r.jsx("span",{className:"font-semibold",children:E.distance})]})}):!F&&r.jsx("div",{className:"text-gray-500 text-sm mb-2",children:"Calculating route..."}),(0,r.jsxs)("button",{className:"w-full mt-3 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-lg transition-colors flex items-center justify-center gap-2 disabled:opacity-60",onClick:()=>{if(t?.customerLocation){let{lat:e,lng:s}=t.customerLocation,r=`https://www.google.com/maps/dir/?api=1&destination=${e},${s}&travelmode=driving`;window.open(r,"_blank")}},disabled:!!F||!E,children:[r.jsx(i.Z,{className:"w-5 h-5"})," Start Navigation"]})]})}),"rider"===s&&r.jsx("div",{className:"absolute bottom-4 left-4",children:r.jsx("div",{className:`px-3 py-2 rounded-lg shadow-lg ${I?"bg-green-600 text-white":"bg-yellow-600 text-white"}`,children:r.jsx("div",{className:"flex items-center gap-2",children:I?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),r.jsx("span",{className:"text-sm font-medium",children:"Live Tracking"})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(d.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"text-sm font-medium",children:"GPS Disabled"})]})})})}),"customer"===s&&t&&v&&r.jsx("div",{className:"absolute bottom-4 left-4 right-4 bg-white rounded-lg shadow-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx(l.Z,{className:"w-6 h-6 text-green-600"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-semibold text-gray-900",children:v.name}),r.jsx("p",{className:"text-sm text-gray-600",children:v.vehicle}),(0,r.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[r.jsx("span",{className:"text-yellow-400",children:"⭐"}),r.jsx("span",{className:"text-sm font-medium",children:v.rating})]})]})]}),r.jsx("button",{onClick:()=>window.open(`tel:${v.phone}`),className:"bg-green-600 text-white p-3 rounded-full hover:bg-green-700 transition-colors",children:r.jsx(m.Z,{className:"w-5 h-5"})})]})})]}):(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center",style:{height:x},children:[r.jsx("div",{className:"text-yellow-600 mb-2",children:r.jsx(d.Z,{className:"w-8 h-8 mx-auto"})}),r.jsx("p",{className:"text-yellow-700 font-medium",children:"Location Data Missing"}),(0,r.jsxs)("p",{className:"text-yellow-600 text-sm mt-1",children:["Rider and/or customer location is not available yet.",r.jsx("br",{}),"Please ensure the rider app is sharing location and the order has a valid delivery address with coordinates."]})]})}}};