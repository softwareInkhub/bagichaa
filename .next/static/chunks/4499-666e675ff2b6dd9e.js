"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4499],{4499:function(e,t,r){r.r(t),r.d(t,{addCategory:function(){return eC},addOrderNote:function(){return eq},addProduct:function(){return ev},addRecentSearch:function(){return ta},assignRiderToOrder:function(){return tf},auth:function(){return ep},authenticateRider:function(){return ti},bulkUpdateOrderStatus:function(){return ez},calculateDistance:function(){return tw},clearCurrentCustomer:function(){return e8},clearCurrentRider:function(){return tD},compressImage:function(){return e4},createCustomer:function(){return eE},createCustomerAccount:function(){return e7},createOrder:function(){return e_},createOrderWithCoordinates:function(){return t_},createRider:function(){return to},createSampleCategories:function(){return eZ},createSampleCustomers:function(){return eQ},createSampleProducts:function(){return e$},createSampleSearchData:function(){return ts},db:function(){return eg},deleteCategory:function(){return eT},deleteImageFromStorage:function(){return e1},deleteProduct:function(){return eD},getAnalyticsData:function(){return eX},getAvailableRiders:function(){return th},getCategories:function(){return eI},getCurrentCustomer:function(){return e9},getCurrentRider:function(){return tv},getCustomer:function(){return eU},getCustomerAnalytics:function(){return eN},getCustomerByPhone:function(){return ex},getCustomerOrders:function(){return eB},getCustomers:function(){return eF},getOrder:function(){return eA},getOrderTracking:function(){return tg},getOrders:function(){return eO},getOrdersByDateRange:function(){return eH},getOrdersByStatus:function(){return eV},getProduct:function(){return eS},getProductAnalytics:function(){return ej},getProducts:function(){return eP},getRecentSearches:function(){return tt},getRevenueAnalytics:function(){return eW},getRiderOrders:function(){return tS},getRiders:function(){return tu},getSearchSuggestions:function(){return te},getTrendingSearches:function(){return tr},isCustomerLoggedIn:function(){return e6},isRiderLoggedIn:function(){return tP},searchProducts:function(){return tn},sendOTP:function(){return ew},setCurrentCustomer:function(){return e5},setCurrentRider:function(){return tb},setupRecaptcha:function(){return ey},storage:function(){return em},subscribeToAnalytics:function(){return eK},subscribeToCustomers:function(){return eY},subscribeToOrderTracking:function(){return tm},subscribeToOrders:function(){return eL},subscribeToProducts:function(){return eM},subscribeToRiderOrders:function(){return tJ},subscribeToRiders:function(){return tc},updateCategory:function(){return ek},updateCustomer:function(){return eR},updateOrderStatus:function(){return eJ},updateOrderStatusWithRider:function(){return tp},updateOrderTracking:function(){return eG},updateProduct:function(){return eb},updateRiderLocation:function(){return td},updateRiderStatus:function(){return tl},updateTrackingLocation:function(){return ty},uploadImage:function(){return e0},uploadMultipleImages:function(){return e2},validateImageFile:function(){return e3}});var n,a,s,i,o,u,c,l,d,h,f,p,g,m,y,w,v,b,D,P,S,_,J,O,A,C,I,k,T,L,M,E,R,F,U,x,B,q,G,H,V,z,X,W,N,j,Y,K,Q,Z,$,ee,et,er,en=r(6687),ea=r(5029),es=r(8965),ei=r(4670),eo=r(1801),eu=r(44),ec=r(994),el=r(7007),ed=r(4086),eh=r(9584),ef=(0,ec.ZF)({apiKey:"AIzaSyDIHawXZZfiYMhBUznsnbXS0LOId9u5FLA",authDomain:"bagichaa-app.firebaseapp.com",projectId:"bagichaa-app",storageBucket:"bagichaa-app.firebasestorage.app",messagingSenderId:"868520218471",appId:"1:868520218471:web:d333c48ee8d01e2b1b69c2"}),ep=(0,el.v0)(ef),eg=(0,ed.ad)(ef),em=(0,eh.cF)(ef);ep.useDeviceLanguage();var ey=function(e){var t=document.getElementById(e);return t&&(t.innerHTML=""),new el.lI(ep,e,{size:"invisible",callback:function(){},"expired-callback":function(){}})},ew=(n=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),!t)throw Error("reCAPTCHA verifier is required");return[4,(0,el.$g)(ep,e,t)];case 1:return[2,n.sent()];case 2:if("auth/billing-not-enabled"===(r=n.sent()).code)throw Error("SMS service not enabled. Please contact support.");if("auth/too-many-requests"===r.code)throw Error("Too many attempts. Please try again later.");if("auth/invalid-phone-number"===r.code)throw Error("Invalid phone number format.");if("auth/missing-phone-number"===r.code)throw Error("Phone number is required.");else if("auth/quota-exceeded"===r.code)throw Error("SMS quota exceeded. Please try again later.");throw r;case 3:return[2]}})}),function(e,t){return n.apply(this,arguments)}),ev=(a=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.ET)((0,ed.hJ)(eg,"products"),(0,es._)((0,ea._)({},e),{createdAt:new Date,updatedAt:new Date}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return a.apply(this,arguments)}),eb=(s=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"products",e),[4,(0,ed.r7)(r,(0,es._)((0,ea._)({},t),{updatedAt:new Date}))];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return s.apply(this,arguments)}),eD=(i=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.oe)((0,ed.JU)(eg,"products",e))];case 1:return t.sent(),[3,3];case 2:throw t.sent();case 3:return[2]}})}),function(e){return i.apply(this,arguments)}),eP=(o=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,ed.PL)((0,ed.hJ)(eg,"products"))];case 1:return[2,e.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw e.sent();case 3:return[2]}})}),function(){return o.apply(this,arguments)}),eS=(u=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,ed.QT)((0,ed.JU)(eg,"products",e))];case 1:if((t=r.sent()).exists())return[2,(0,ea._)({id:t.id},t.data())];throw Error("Product not found");case 2:throw r.sent();case 3:return[2]}})}),function(e){return u.apply(this,arguments)}),e_=(c=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.ET)((0,ed.hJ)(eg,"orders"),(0,es._)((0,ea._)({},e),{status:"pending",createdAt:new Date,updatedAt:new Date}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return c.apply(this,arguments)}),eJ=(l=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"orders",e),[4,(0,ed.r7)(r,{status:t,updatedAt:new Date})];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return l.apply(this,arguments)}),eO=(d=(0,en._)(function(){var e;return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.Xo)("createdAt","desc")),[4,(0,ed.PL)(e)];case 1:return[2,t.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw t.sent();case 3:return[2]}})}),function(){return d.apply(this,arguments)}),eA=(h=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,ed.QT)((0,ed.JU)(eg,"orders",e))];case 1:if((t=r.sent()).exists())return[2,(0,ea._)({id:t.id},t.data())];return[2,null];case 2:throw r.sent();case 3:return[2]}})}),function(e){return h.apply(this,arguments)}),eC=(f=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.ET)((0,ed.hJ)(eg,"categories"),(0,es._)((0,ea._)({},e),{createdAt:new Date,updatedAt:new Date}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return f.apply(this,arguments)}),eI=(p=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,ed.PL)((0,ed.hJ)(eg,"categories"))];case 1:return[2,e.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw e.sent();case 3:return[2]}})}),function(){return p.apply(this,arguments)}),ek=(g=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"categories",e),[4,(0,ed.r7)(r,(0,es._)((0,ea._)({},t),{updatedAt:new Date}))];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return g.apply(this,arguments)}),eT=(m=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.oe)((0,ed.JU)(eg,"categories",e))];case 1:return t.sent(),[3,3];case 2:throw t.sent();case 3:return[2]}})}),function(e){return m.apply(this,arguments)}),eL=function(e){var t=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.Xo)("createdAt","desc"));return(0,ed.cf)(t,function(t){e(t.docs.map(function(e){return(0,ea._)({id:e.id},e.data())}))})},eM=function(e){var t=(0,ed.IO)((0,ed.hJ)(eg,"products"),(0,ed.Xo)("createdAt","desc"));return(0,ed.cf)(t,function(t){e(t.docs.map(function(e){return(0,ea._)({id:e.id},e.data())}))})},eE=(y=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.ET)((0,ed.hJ)(eg,"customers"),(0,es._)((0,ea._)({},e),{createdAt:new Date,updatedAt:new Date,totalOrders:0,totalSpent:0,lastOrderDate:null,loyaltyPoints:0,preferredCategories:[],averageOrderValue:0}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return y.apply(this,arguments)}),eR=(w=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"customers",e),[4,(0,ed.r7)(r,(0,es._)((0,ea._)({},t),{updatedAt:new Date}))];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return w.apply(this,arguments)}),eF=(v=(0,en._)(function(){var e;return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=(0,ed.IO)((0,ed.hJ)(eg,"customers"),(0,ed.Xo)("totalSpent","desc")),[4,(0,ed.PL)(e)];case 1:return[2,t.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw t.sent();case 3:return[2]}})}),function(){return v.apply(this,arguments)}),eU=(b=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,ed.QT)((0,ed.JU)(eg,"customers",e))];case 1:if((t=r.sent()).exists())return[2,(0,ea._)({id:t.id},t.data())];throw Error("Customer not found");case 2:throw r.sent();case 3:return[2]}})}),function(e){return b.apply(this,arguments)}),ex=(D=(0,en._)(function(e){var t,r,n;return(0,eu.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=(0,ed.IO)((0,ed.hJ)(eg,"customers"),(0,ed.ar)("phone","==",e)),[4,(0,ed.PL)(t)];case 1:if(!(r=a.sent()).empty)return n=r.docs[0],[2,(0,ea._)({id:n.id},n.data())];return[2,null];case 2:throw a.sent();case 3:return[2]}})}),function(e){return D.apply(this,arguments)}),eB=(P=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.ar)("customerId","==",e),(0,ed.Xo)("createdAt","desc")),[4,(0,ed.PL)(t)];case 1:return[2,r.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw r.sent();case 3:return[2]}})}),function(e){return P.apply(this,arguments)}),eq=(S=(0,en._)(function(e,t,r){var n,a,s,i;return(0,eu.Jh)(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),n=(0,ed.JU)(eg,"orders",e),[4,(0,ed.QT)(n)];case 1:if(!(a=o.sent()).exists())return[3,3];return s=a.data().notes||[],i={id:Date.now().toString(),note:t,addedBy:r,addedAt:new Date},[4,(0,ed.r7)(n,{notes:(0,eo._)(s).concat([i]),updatedAt:new Date})];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:throw o.sent();case 5:return[2]}})}),function(e,t,r){return S.apply(this,arguments)}),eG=(_=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"orders",e),[4,(0,ed.r7)(r,{tracking:t,updatedAt:new Date})];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return _.apply(this,arguments)}),eH=(J=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.ar)("createdAt",">=",e),(0,ed.ar)("createdAt","<=",t),(0,ed.Xo)("createdAt","desc")),[4,(0,ed.PL)(r)];case 1:return[2,n.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return J.apply(this,arguments)}),eV=(O=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.ar)("status","==",e),(0,ed.Xo)("createdAt","desc")),[4,(0,ed.PL)(t)];case 1:return[2,r.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw r.sent();case 3:return[2]}})}),function(e){return O.apply(this,arguments)}),ez=(A=(0,en._)(function(e,t){var r,n,a,s,i,o,u,c;return(0,eu.Jh)(this,function(l){switch(l.label){case 0:l.trys.push([0,2,,3]),r=[],n=!0,a=!1,s=void 0;try{for(i=e[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)u=o.value,c=(0,ed.JU)(eg,"orders",u),r.push((0,ed.r7)(c,{status:t,updatedAt:new Date}))}catch(e){a=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw s}}return[4,Promise.all(r)];case 1:return l.sent(),[3,3];case 2:throw l.sent();case 3:return[2]}})}),function(e,t){return A.apply(this,arguments)}),eX=(C=(0,en._)(function(){var e,t,r,n,a=arguments;return(0,eu.Jh)(this,function(s){switch(s.label){case 0:e=a.length>0&&void 0!==a[0]?a[0]:"month",s.label=1;case 1:switch(s.trys.push([1,3,,4]),t=new Date,r=new Date,e){case"day":r.setDate(t.getDate()-30);break;case"week":r.setDate(t.getDate()-84);break;case"month":r.setMonth(t.getMonth()-12);break;case"year":r.setFullYear(t.getFullYear()-5)}return[4,Promise.all([eH(r,t),eP(),eF()])];case 2:return[2,{orders:(n=ei._.apply(void 0,[s.sent(),3]))[0],products:n[1],customers:n[2],period:e,dateRange:{startDate:r,endDate:t}}];case 3:throw s.sent();case 4:return[2]}})}),function(){return C.apply(this,arguments)}),eW=(I=(0,en._)(function(){var e,t,r,n,a,s,i,o,u=arguments;return(0,eu.Jh)(this,function(c){switch(c.label){case 0:e=u.length>0&&void 0!==u[0]?u[0]:"month",c.label=1;case 1:return c.trys.push([1,3,,4]),[4,eX(e)];case 2:return t=c.sent().orders,r=new Map,n=new Map,a=new Map,s=0,i=t.length,o=0,t.forEach(function(t){var i,o,u=(null===(i=t.createdAt)||void 0===i?void 0:i.toDate())||new Date(t.createdAt),c=t.total||0;s+=c;var l="";switch(e){case"day":l=u.toISOString().split("T")[0];break;case"week":var d=new Date(u);d.setDate(u.getDate()-u.getDay()),l=d.toISOString().split("T")[0];break;case"month":l="".concat(u.getFullYear(),"-").concat((u.getMonth()+1).toString().padStart(2,"0"));break;case"year":l=u.getFullYear().toString()}r.set(l,(r.get(l)||0)+c),null===(o=t.items)||void 0===o||o.forEach(function(e){var t=(e.price||0)*(e.qty||0);a.set(e.name,(a.get(e.name)||0)+t);var r=e.category||"Other";n.set(r,(n.get(r)||0)+t)})}),o=i>0?s/i:0,[2,{totalRevenue:s,totalOrders:i,averageOrderValue:o,revenueByPeriod:Array.from(r.entries()).map(function(e){var t=(0,ei._)(e,2);return{period:t[0],revenue:t[1]}}),revenueByCategory:Array.from(n.entries()).map(function(e){var t=(0,ei._)(e,2);return{category:t[0],revenue:t[1]}}),topProducts:Array.from(a.entries()).map(function(e){var t=(0,ei._)(e,2);return{name:t[0],revenue:t[1]}}).sort(function(e,t){return t.revenue-e.revenue}).slice(0,10)}];case 3:throw c.sent();case 4:return[2]}})}),function(){return I.apply(this,arguments)}),eN=(k=(0,en._)(function(){var e,t,r,n,a,s,i,o,u;return(0,eu.Jh)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,Promise.all([eF(),eO()])];case 1:if(t=(e=ei._.apply(void 0,[c.sent(),2]))[0],e[1],!t||0===t.length)return[2,{totalCustomers:0,segments:{new:0,active:0,inactive:0,churned:0},averageLifetimeValue:0,geographicDistribution:[],topCustomers:[]}];return r={new:0,active:0,inactive:0,churned:0},n=new Map,a=new Map,s=new Map,i=new Date,t.forEach(function(e){var t=e.lastOrderDate;t=t?t.toDate?t.toDate():new Date(t):e.createdAt?e.createdAt.toDate?e.createdAt.toDate():new Date(e.createdAt):new Date;var o=(i.getTime()-t.getTime())/864e5;o<=30?r.new++:o<=90?r.active++:o<=180?r.inactive++:r.churned++,n.set(e.id,e.totalSpent||0),a.set(e.id,e.totalOrders||0);var u="".concat(e.city||"Unknown",", ").concat(e.state||"Unknown");s.set(u,(s.get(u)||0)+1)}),o=t.reduce(function(e,t){return e+(t.totalSpent||0)},0),u=t.length>0?o/t.length:0,[2,{totalCustomers:t.length,segments:r,averageLifetimeValue:u,geographicDistribution:Array.from(s.entries()).map(function(e){var t=(0,ei._)(e,2);return{location:t[0],count:t[1]}}),topCustomers:t.slice(0,10).map(function(e){return{id:e.id,name:e.name,phone:e.phone,totalSpent:e.totalSpent||0,totalOrders:e.totalOrders||0}})}];case 2:return c.sent(),[2,{totalCustomers:0,segments:{new:0,active:0,inactive:0,churned:0},averageLifetimeValue:0,geographicDistribution:[],topCustomers:[]}];case 3:return[2]}})}),function(){return k.apply(this,arguments)}),ej=(T=(0,en._)(function(){var e,t,r,n,a,s,i;return(0,eu.Jh)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Promise.all([eP(),eO()])];case 1:return t=(e=ei._.apply(void 0,[o.sent(),2]))[0],r=e[1],n=new Map,a=new Map,t.forEach(function(e){n.set(e.id,{name:e.name,category:e.category,price:e.price,inventory:e.inventory||0,sold:0,revenue:0})}),r.forEach(function(e){var t;null===(t=e.items)||void 0===t||t.forEach(function(e){var t=e.productId||e.id;if(n.has(t)){var r=n.get(t);r.sold+=e.qty||0,r.revenue+=(e.price||0)*(e.qty||0);var s=r.category||"Other",i=a.get(s)||{sold:0,revenue:0};i.sold+=e.qty||0,i.revenue+=(e.price||0)*(e.qty||0),a.set(s,i)}})}),s=Array.from(n.values()).sort(function(e,t){return t.sold-e.sold}).slice(0,10),i=Array.from(n.values()).sort(function(e,t){return t.revenue-e.revenue}).slice(0,10),[2,{totalProducts:t.length,topSellingProducts:s,topRevenueProducts:i,categoryPerformance:Array.from(a.entries()).map(function(e){var t=(0,ei._)(e,2),r=t[0],n=t[1];return(0,ea._)({category:r},n)}),lowStockAlerts:Array.from(n.values()).filter(function(e){return e.inventory<10})}];case 2:throw o.sent();case 3:return[2]}})}),function(){return T.apply(this,arguments)}),eY=function(e){var t=(0,ed.IO)((0,ed.hJ)(eg,"customers"),(0,ed.Xo)("totalSpent","desc"));return(0,ed.cf)(t,function(t){e(t.docs.map(function(e){return(0,ea._)({id:e.id},e.data())}))})},eK=function(e){var t,r=(0,ed.IO)((0,ed.hJ)(eg,"orders"),(0,ed.Xo)("createdAt","desc"),(0,ed.b9)(100));return(0,ed.cf)(r,(t=(0,en._)(function(t){var r,n,a,s;return(0,eu.Jh)(this,function(i){return n=(r=t.docs.map(function(e){return(0,ea._)({id:e.id},e.data())})).reduce(function(e,t){return e+(t.total||0)},0),s=(a=r.length)>0?n/a:0,e({totalRevenue:n,totalOrders:a,averageOrderValue:s,statusCounts:r.reduce(function(e,t){return e[t.status]=(e[t.status]||0)+1,e},{}),recentOrders:r.slice(0,10)}),[2]})}),function(e){return t.apply(this,arguments)}))},eQ=(L=(0,en._)(function(){var e,t,r,n,a,s,i,o,u;return(0,eu.Jh)(this,function(c){switch(c.label){case 0:c.trys.push([0,9,,10]),e=[{name:"Rajesh Kumar",phone:"+91-9876543210",email:"rajesh.kumar@email.com",city:"Delhi",state:"Delhi",totalOrders:5,totalSpent:12500,lastOrderDate:new Date(Date.now()-1296e6),firstOrderDate:new Date(Date.now()-7776e6),loyaltyPoints:125,preferredCategories:["plants","fertilizers"]},{name:"Priya Sharma",phone:"+91-9876543211",email:"priya.sharma@email.com",city:"Mumbai",state:"Maharashtra",totalOrders:8,totalSpent:18750,lastOrderDate:new Date(Date.now()-432e6),firstOrderDate:new Date(Date.now()-10368e6),loyaltyPoints:188,preferredCategories:["plants","tools"]},{name:"Amit Patel",phone:"+91-9876543212",email:"amit.patel@email.com",city:"Bangalore",state:"Karnataka",totalOrders:3,totalSpent:7250,lastOrderDate:new Date(Date.now()-3888e6),firstOrderDate:new Date(Date.now()-648e7),loyaltyPoints:72,preferredCategories:["seeds","fertilizers"]},{name:"Sunita Verma",phone:"+91-9876543213",email:"sunita.verma@email.com",city:"Chennai",state:"Tamil Nadu",totalOrders:12,totalSpent:28900,lastOrderDate:new Date(Date.now()-1728e5),firstOrderDate:new Date(Date.now()-15552e6),loyaltyPoints:289,preferredCategories:["plants","fertilizers","tools"]},{name:"Ravi Singh",phone:"+91-9876543214",city:"Pune",state:"Maharashtra",totalOrders:2,totalSpent:4500,lastOrderDate:new Date(Date.now()-10368e6),firstOrderDate:new Date(Date.now()-1296e7),loyaltyPoints:45,preferredCategories:["seeds"]},{name:"Meera Gupta",phone:"+91-9876543215",email:"meera.gupta@email.com",city:"Kolkata",state:"West Bengal",totalOrders:6,totalSpent:15200,lastOrderDate:new Date(Date.now()-864e6),firstOrderDate:new Date(Date.now()-864e7),loyaltyPoints:152,preferredCategories:["plants","tools"]},{name:"Karan Joshi",phone:"+91-9876543216",email:"karan.joshi@email.com",city:"Ahmedabad",state:"Gujarat",totalOrders:4,totalSpent:9800,lastOrderDate:new Date(Date.now()-2592e6),firstOrderDate:new Date(Date.now()-6912e6),loyaltyPoints:98,preferredCategories:["fertilizers","tools"]},{name:"Deepika Reddy",phone:"+91-9876543217",email:"deepika.reddy@email.com",city:"Hyderabad",state:"Telangana",totalOrders:9,totalSpent:22300,lastOrderDate:new Date(Date.now()-6048e5),firstOrderDate:new Date(Date.now()-11232e6),loyaltyPoints:223,preferredCategories:["plants","fertilizers","seeds"]}],t=[],r=!0,n=!1,a=void 0,c.label=1;case 1:c.trys.push([1,6,7,8]),s=e[Symbol.iterator](),c.label=2;case 2:if(r=(i=s.next()).done)return[3,5];return[4,eE(i.value)];case 3:o=c.sent(),t.push(o),c.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return u=c.sent(),n=!0,a=u,[3,8];case 7:try{r||null==s.return||s.return()}finally{if(n)throw a}return[7];case 8:return[2,t];case 9:throw c.sent();case 10:return[2]}})}),function(){return L.apply(this,arguments)}),eZ=(M=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all([{name:"Indoor Plants",description:"Perfect plants for your home and office spaces",icon:"\uD83E\uDEB4",subcategories:["Succulents","Ferns","Air Purifying","Low Light","Snake Plants","Pothos","Monstera","Peace Lily"]},{name:"Outdoor Plants",description:"Beautiful plants for gardens and outdoor spaces",icon:"\uD83C\uDF33",subcategories:["Trees","Shrubs","Climbers","Ground Cover","Fruit Trees","Flowering Trees","Shade Trees"]},{name:"Flowering Plants",description:"Vibrant flowers to brighten your space",icon:"\uD83C\uDF38",subcategories:["Roses","Lilies","Marigolds","Jasmine","Sunflowers","Petunias","Orchids","Tulips"]},{name:"Tools",description:"Professional gardening tools and equipment",icon:"\uD83D\uDEE0️",subcategories:["Hand Tools","Watering Tools","Pruning Tools","Digging Tools","Measuring Tools","Protective Gear"]},{name:"Soil & Fertilizer",description:"Organic soil and plant nutrition products",icon:"\uD83E\uDEA8",subcategories:["Potting Mix","Organic Fertilizers","Liquid Fertilizers","Compost","Soil Amendments","Mulch"]},{name:"Pots & Planters",description:"Beautiful containers for your plants",icon:"\uD83C\uDFFA",subcategories:["Ceramic Pots","Plastic Planters","Terracotta Pots","Hanging Planters","Self-Watering","Decorative Pots"]},{name:"Seeds",description:"High-quality seeds for growing your own plants",icon:"\uD83C\uDF3E",subcategories:["Flower Seeds","Vegetable Seeds","Herb Seeds","Grass Seeds","Exotic Seeds","Organic Seeds"]}].map(function(e){return eC(e)}))];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}})}),function(){return M.apply(this,arguments)}),e$=(E=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all([{name:"Snake Plant (Sansevieria)",category:"Indoor Plants",subcategory:"Snake Plants",price:599,originalPrice:799,rating:4.8,reviews:234,image:"",badge:"Bestseller",badgeColor:"bg-green-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Air Purifying","Low Maintenance","Low Light Tolerant"],description:"Perfect air-purifying plant for beginners. Thrives in low light and requires minimal watering."},{name:"Monstera Deliciosa",category:"Indoor Plants",subcategory:"Monstera",price:1299,originalPrice:1599,rating:4.9,reviews:156,image:"",badge:"Premium",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!0,features:["Instagram Favorite","Fast Growing","Statement Plant"],description:"Popular tropical houseplant with stunning split leaves. Perfect for bright, indirect light."},{name:"Rose Plant - Red Beauty",category:"Flowering Plants",subcategory:"Roses",price:349,originalPrice:499,rating:4.6,reviews:89,image:"",badge:"New",badgeColor:"bg-blue-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Fragrant Blooms","Long Lasting","Garden Classic"],description:"Beautiful red roses that bloom throughout the season. Perfect for gardens and bouquets."},{name:"Professional Pruning Shears",category:"Tools",subcategory:"Pruning Tools",price:899,originalPrice:1199,rating:4.7,reviews:267,image:"",badge:"Tool of the Month",badgeColor:"bg-orange-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Sharp Blades","Ergonomic Handle","Lifetime Warranty"],description:"Professional-grade pruning shears for precise cuts. Ideal for roses, shrubs, and small branches."},{name:"Organic Potting Mix - 5kg",category:"Soil & Fertilizer",subcategory:"Potting Mix",price:299,originalPrice:399,rating:4.5,reviews:445,image:"",badge:"Organic",badgeColor:"bg-emerald-500",inStock:!0,fastDelivery:!0,organic:!0,features:["100% Organic","Ready to Use","Nutrient Rich"],description:"Premium organic potting mix perfect for indoor and outdoor plants. Enriched with natural nutrients."},{name:"Ceramic Planter - White",category:"Pots & Planters",subcategory:"Ceramic Pots",price:799,originalPrice:999,rating:4.4,reviews:123,image:"",badge:"Trending",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Drainage Holes","Modern Design","Weather Resistant"],description:"Elegant white ceramic planter with drainage holes. Perfect for indoor and covered outdoor spaces."},{name:"Sunflower Seeds - Premium Mix",category:"Seeds",subcategory:"Flower Seeds",price:149,originalPrice:199,rating:4.6,reviews:89,image:"",badge:"Flower Seeds",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Fast Germination","High Yield","Disease Resistant"],description:"Premium sunflower seed mix for beautiful garden blooms. Easy to grow and perfect for beginners."},{name:"Organic Tomato Seeds - Cherry Variety",category:"Seeds",subcategory:"Vegetable Seeds",price:99,originalPrice:129,rating:4.8,reviews:156,image:"",badge:"Vegetable Seeds",badgeColor:"bg-green-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Organic Certified","Sweet Flavor","High Yield"],description:"Organic cherry tomato seeds that produce sweet, juicy fruits. Perfect for containers and gardens."},{name:"Basil Seeds - Sweet Genovese",category:"Seeds",subcategory:"Herb Seeds",price:79,originalPrice:99,rating:4.7,reviews:234,image:"",badge:"Herb Seeds",badgeColor:"bg-emerald-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Aromatic","Fast Growing","Culinary Use"],description:"Classic Genovese basil seeds for aromatic herbs. Essential for Italian cooking and pesto making."},{name:"Lawn Grass Seeds - Bermuda Mix",category:"Seeds",subcategory:"Grass Seeds",price:299,originalPrice:399,rating:4.5,reviews:67,image:"",badge:"Grass Seeds",badgeColor:"bg-lime-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Drought Resistant","Low Maintenance","Dense Growth"],description:"Premium Bermuda grass seed mix for lush, green lawns. Perfect for warm climates and high-traffic areas."},{name:"Exotic Orchid Seeds - Phalaenopsis",category:"Seeds",subcategory:"Exotic Seeds",price:599,originalPrice:799,rating:4.9,reviews:45,image:"",badge:"Exotic Seeds",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Rare Variety","Beautiful Blooms","Collector Item"],description:"Rare Phalaenopsis orchid seeds for exotic flower enthusiasts. Requires special care but produces stunning blooms."},{name:"Ceramic Planter - Modern White",category:"Pots & Planters",subcategory:"Ceramic Pots",price:899,originalPrice:1199,rating:4.7,reviews:189,image:"",badge:"Ceramic Pots",badgeColor:"bg-blue-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Drainage Holes","Modern Design","Weather Resistant"],description:"Elegant white ceramic planter with drainage holes. Perfect for indoor and covered outdoor spaces."},{name:"Hanging Planter - Macrame Style",category:"Pots & Planters",subcategory:"Hanging Planters",price:649,originalPrice:849,rating:4.6,reviews:234,image:"",badge:"Hanging Planters",badgeColor:"bg-purple-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Macrame Design","Adjustable Length","Indoor Use"],description:"Beautiful macrame hanging planter perfect for trailing plants. Adds bohemian charm to any space."},{name:"Self-Watering Planter - Smart Pot",category:"Pots & Planters",subcategory:"Self-Watering",price:1299,originalPrice:1599,rating:4.8,reviews:156,image:"",badge:"Self-Watering",badgeColor:"bg-teal-500",inStock:!0,fastDelivery:!0,organic:!1,features:["Water Reservoir","Moisture Indicator","Overflow Protection"],description:"Smart self-watering planter with built-in water reservoir. Perfect for busy plant parents."},{name:"Terracotta Pot - Classic Round",category:"Pots & Planters",subcategory:"Terracotta Pots",price:299,originalPrice:399,rating:4.5,reviews:445,image:"",badge:"Terracotta Pots",badgeColor:"bg-orange-500",inStock:!0,fastDelivery:!0,organic:!0,features:["Natural Material","Breathable","Classic Design"],description:"Classic terracotta pot made from natural clay. Excellent for root health and moisture regulation."},{name:"Decorative Planter - Geometric Pattern",category:"Pots & Planters",subcategory:"Decorative Pots",price:799,originalPrice:999,rating:4.4,reviews:123,image:"",badge:"Decorative Pots",badgeColor:"bg-pink-500",inStock:!0,fastDelivery:!1,organic:!1,features:["Geometric Design","Modern Aesthetic","Statement Piece"],description:"Stunning geometric planter that doubles as home decor. Perfect for showcasing your favorite plants."}].map(function(e){return ev(e)}))];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}})}),function(){return E.apply(this,arguments)}),e0=(R=(0,en._)(function(e){var t,r,n,a,s,i=arguments;return(0,eu.Jh)(this,function(o){switch(o.label){case 0:t=i.length>1&&void 0!==i[1]?i[1]:"images",o.label=1;case 1:return o.trys.push([1,4,,5]),r=Date.now(),n="".concat(r,"_").concat(e.name),a=(0,eh.iH)(em,"".concat(t,"/").concat(n)),[4,(0,eh.KV)(a,e)];case 2:return s=o.sent(),[4,(0,eh.Jt)(s.ref)];case 3:return[2,o.sent()];case 4:throw o.sent(),Error("Failed to upload image. Please try again.");case 5:return[2]}})}),function(e){return R.apply(this,arguments)}),e2=(F=(0,en._)(function(e){var t,r=arguments;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:t=r.length>1&&void 0!==r[1]?r[1]:"images",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all(e.map(function(e){return e0(e,t)}))];case 2:return[2,n.sent()];case 3:throw n.sent(),Error("Failed to upload images. Please try again.");case 4:return[2]}})}),function(e){return F.apply(this,arguments)}),e1=(U=(0,en._)(function(e){var t,r,n;return(0,eu.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),r=(t=e.split("/"))[t.length-1].split("?")[0],n=(0,eh.iH)(em,r),[4,(0,eh.oq)(n)];case 1:return a.sent(),[2,!0];case 2:return a.sent(),[2,!1];case 3:return[2]}})}),function(e){return U.apply(this,arguments)}),e3=function(e){return["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type)?e.size>5242880?{isValid:!1,error:"Image size must be less than 5MB"}:{isValid:!0}:{isValid:!1,error:"Please select a valid image file (JPEG, PNG, WebP, or GIF)"}},e4=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return new Promise(function(n){var a=document.createElement("canvas"),s=a.getContext("2d"),i=new Image;i.onload=function(){var o=Math.min(t/i.width,t/i.height);a.width=i.width*o,a.height=i.height*o,null==s||s.drawImage(i,0,0,a.width,a.height),a.toBlob(function(t){t?n(new File([t],e.name,{type:e.type,lastModified:Date.now()})):n(e)},e.type,r)},i.src=URL.createObjectURL(e)})},e9=function(){var e=localStorage.getItem("currentCustomer");return e?JSON.parse(e):null},e5=function(e){localStorage.setItem("currentCustomer",JSON.stringify(e))},e8=function(){localStorage.removeItem("currentCustomer")},e6=function(){return null!==e9()},e7=(x=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,eE((0,es._)((0,ea._)({},e),{createdAt:new Date,firstOrderDate:null,lastOrderDate:null,totalOrders:0,totalSpent:0,loyaltyPoints:0,preferredCategories:[],isActive:!0}))];case 1:return[2,t.sent()];case 2:throw t.sent();case 3:return[2]}})}),function(e){return x.apply(this,arguments)}),te=(B=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,ed.PL)((0,ed.hJ)(eg,"searchSuggestions"))];case 1:return[2,e.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:return e.sent(),[2,[]];case 3:return[2]}})}),function(){return B.apply(this,arguments)}),tt=(q=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,ed.PL)((0,ed.hJ)(eg,"recentSearches"))];case 1:return[2,e.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:return e.sent(),[2,[]];case 3:return[2]}})}),function(){return q.apply(this,arguments)}),tr=(G=(0,en._)(function(){return(0,eu.Jh)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,ed.PL)((0,ed.hJ)(eg,"trendingSearches"))];case 1:return[2,e.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:return e.sent(),[2,[]];case 3:return[2]}})}),function(){return G.apply(this,arguments)}),tn=(H=(0,en._)(function(e){var t,r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,eP()];case 1:return t=n.sent(),r=e.toLowerCase(),[2,t.filter(function(e){var t,n,a,s,i,o=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||"",u=(null===(n=e.category)||void 0===n?void 0:n.toLowerCase())||"",c=(null===(a=e.subcategory)||void 0===a?void 0:a.toLowerCase())||"",l=(null===(s=e.description)||void 0===s?void 0:s.toLowerCase())||"",d=(null===(i=e.features)||void 0===i?void 0:i.join(" ").toLowerCase())||"";return o.includes(r)||u.includes(r)||c.includes(r)||l.includes(r)||d.includes(r)})];case 2:return n.sent(),[2,[]];case 3:return[2]}})}),function(e){return H.apply(this,arguments)}),ta=(V=(0,en._)(function(e){var t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),[4,tt()];case 1:if(!(t=r.sent().find(function(t){return t.term===e})))return[3,3];return[4,(0,ed.r7)((0,ed.JU)(eg,"recentSearches",t.id),{timestamp:new Date})];case 2:return r.sent(),[3,5];case 3:return[4,(0,ed.ET)((0,ed.hJ)(eg,"recentSearches"),{term:e,timestamp:new Date})];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return r.sent(),[3,7];case 7:return[2]}})}),function(e){return V.apply(this,arguments)}),ts=(z=(0,en._)(function(){var e,t,r,n,a,s,i,o,u,c,l,d,h,f,p,g,m,y,w,v,b,D;return(0,eu.Jh)(this,function(P){switch(P.label){case 0:P.trys.push([0,25,,26]),e=[{term:"monstera plant",type:"product",category:"Indoor Plants"},{term:"snake plant",type:"product",category:"Indoor Plants"},{term:"gardening tools",type:"category",category:"Tools"},{term:"organic soil",type:"product",category:"Soil & Fertilizer"},{term:"flower seeds",type:"product",category:"Seeds"},{term:"plant pots",type:"product",category:"Pots & Planters"},{term:"fertilizer",type:"category",category:"Soil & Fertilizer"},{term:"succulents",type:"product",category:"Indoor Plants"},{term:"air purifying plants",type:"product",category:"Indoor Plants"},{term:"herb garden",type:"category",category:"Seeds"},{term:"bonsai trees",type:"product",category:"Outdoor Plants"},{term:"vertical garden",type:"category",category:"Tools"}],t=[{term:"monstera plant",timestamp:new Date(Date.now()-72e5)},{term:"gardening tools",timestamp:new Date(Date.now()-864e5)},{term:"organic soil",timestamp:new Date(Date.now()-1728e5)},{term:"flower seeds",timestamp:new Date(Date.now()-2592e5)},{term:"plant pots",timestamp:new Date(Date.now()-432e6)}],r=[{term:"succulents",count:156,trend:"up"},{term:"air purifying plants",count:134,trend:"up"},{term:"herb garden",count:98,trend:"up"},{term:"bonsai trees",count:87,trend:"stable"},{term:"vertical garden",count:76,trend:"up"}],n=!0,a=!1,s=void 0,P.label=1;case 1:P.trys.push([1,6,7,8]),i=e[Symbol.iterator](),P.label=2;case 2:if(n=(o=i.next()).done)return[3,5];return u=o.value,[4,(0,ed.ET)((0,ed.hJ)(eg,"searchSuggestions"),u)];case 3:P.sent(),P.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return c=P.sent(),a=!0,s=c,[3,8];case 7:try{n||null==i.return||i.return()}finally{if(a)throw s}return[7];case 8:l=!0,d=!1,h=void 0,P.label=9;case 9:P.trys.push([9,14,15,16]),f=t[Symbol.iterator](),P.label=10;case 10:if(l=(p=f.next()).done)return[3,13];return g=p.value,[4,(0,ed.ET)((0,ed.hJ)(eg,"recentSearches"),g)];case 11:P.sent(),P.label=12;case 12:return l=!0,[3,10];case 13:return[3,16];case 14:return c=P.sent(),d=!0,h=c,[3,16];case 15:try{l||null==f.return||f.return()}finally{if(d)throw h}return[7];case 16:m=!0,y=!1,w=void 0,P.label=17;case 17:P.trys.push([17,22,23,24]),v=r[Symbol.iterator](),P.label=18;case 18:if(m=(b=v.next()).done)return[3,21];return D=b.value,[4,(0,ed.ET)((0,ed.hJ)(eg,"trendingSearches"),D)];case 19:P.sent(),P.label=20;case 20:return m=!0,[3,18];case 21:return[3,24];case 22:return c=P.sent(),y=!0,w=c,[3,24];case 23:try{m||null==v.return||v.return()}finally{if(y)throw w}return[7];case 24:return[2,!0];case 25:return P.sent(),[2,!1];case 26:return[2]}})}),function(){return z.apply(this,arguments)});t.default=ef;var ti=(X=(0,en._)(function(e,t,r){var n,a,s,i,o;return(0,eu.Jh)(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),[4,r.confirm(t)];case 1:return u.sent().user,n=(0,ed.hJ)(eg,"riders"),a=(0,ed.IO)(n,(0,ed.ar)("phone","==",e)),[4,(0,ed.PL)(a)];case 2:if((s=u.sent()).empty)throw Error("Rider not found. Please contact admin for registration.");if(i=s.docs[0],!(o=(0,ea._)({id:i.id},i.data())).isActive)throw Error("Rider account is deactivated. Please contact admin.");return[4,(0,ed.r7)(i.ref,{lastActiveAt:new Date,status:"online"})];case 3:return u.sent(),[2,o];case 4:throw u.sent();case 5:return[2]}})}),function(e,t,r){return X.apply(this,arguments)}),to=(W=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,ed.ET)((0,ed.hJ)(eg,"riders"),(0,es._)((0,ea._)({},e),{status:"offline",currentLocation:null,currentOrderId:null,totalDeliveries:0,completedDeliveries:0,cancelledDeliveries:0,rating:5,totalEarnings:0,isActive:!0,isVerified:!1,performance:{avgDeliveryTime:0,onTimeDeliveryRate:100,customerRating:5},createdAt:new Date,lastLocationUpdate:null,lastActiveAt:null}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return W.apply(this,arguments)}),tu=(N=(0,en._)(function(){var e,t;return(0,eu.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=(0,ed.hJ)(eg,"riders"),t=(0,ed.IO)(e,(0,ed.Xo)("createdAt","desc")),[4,(0,ed.PL)(t)];case 1:return[2,r.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw r.sent();case 3:return[2]}})}),function(){return N.apply(this,arguments)}),tc=function(e){var t=(0,ed.hJ)(eg,"riders"),r=(0,ed.IO)(t,(0,ed.Xo)("createdAt","desc"));return(0,ed.cf)(r,function(t){e(t.docs.map(function(e){return(0,ea._)({id:e.id},e.data())}))})},tl=(j=(0,en._)(function(e,t){var r;return(0,eu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=(0,ed.JU)(eg,"riders",e),[4,(0,ed.r7)(r,{status:t,lastActiveAt:new Date})];case 1:return n.sent(),[3,3];case 2:throw n.sent();case 3:return[2]}})}),function(e,t){return j.apply(this,arguments)}),td=(Y=(0,en._)(function(e,t){var r,n,a,s,i,o;return(0,eu.Jh)(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),r=(0,ed.JU)(eg,"riders",e),[4,(0,ed.r7)(r,{currentLocation:(0,es._)((0,ea._)({},t),{accuracy:10,timestamp:new Date}),lastLocationUpdate:new Date})];case 1:return u.sent(),[4,(0,ed.QT)(r)];case 2:if(!(a=null==(n=u.sent().data())?void 0:n.currentOrderId))return[3,5];return s=(0,ed.IO)((0,ed.hJ)(eg,"order_tracking"),(0,ed.ar)("orderId","==",a)),[4,(0,ed.PL)(s)];case 3:if((i=u.sent()).empty)return[3,5];return o=i.docs[0],[4,(0,ed.r7)(o.ref,{riderLocation:t,updatedAt:new Date})];case 4:u.sent(),u.label=5;case 5:return[3,7];case 6:throw u.sent();case 7:return[2]}})}),function(e,t){return Y.apply(this,arguments)}),th=(K=(0,en._)(function(e){var t,r,n;return(0,eu.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=(0,ed.hJ)(eg,"riders"),r=(0,ed.IO)(t,(0,ed.ar)("status","in",["online"]),(0,ed.ar)("isActive","==",!0)),[4,(0,ed.PL)(r)];case 1:if(n=a.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())}),e)return[2,n.filter(function(e){return e.currentLocation}).sort(function(t,r){return tw(e,t.currentLocation)-tw(e,r.currentLocation)})];return[2,n];case 2:throw a.sent();case 3:return[2]}})}),function(e){return K.apply(this,arguments)}),tf=(Q=(0,en._)(function(e,t){var r,n,a,s,i,o,u,c;return(0,eu.Jh)(this,function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),r=(0,ed.qs)(eg),n=(0,ed.JU)(eg,"orders",e),r.update(n,{riderId:t,status:"assigned",riderAssignedAt:new Date,updatedAt:new Date}),a=(0,ed.JU)(eg,"riders",t),r.update(a,{status:"busy",currentOrderId:e,lastActiveAt:new Date}),[4,(0,ed.QT)(n)];case 1:return s=l.sent(),i=null,s.exists()&&(i=(null==(u=s.data())?void 0:null===(o=u.address)||void 0===o?void 0:o.coordinates)||null),c=(0,ed.JU)((0,ed.hJ)(eg,"order_tracking")),r.set(c,{orderId:e,riderId:t,status:"assigned",customerLocation:i,riderLocation:null,estimatedArrival:null,actualDistance:null,estimatedDistance:null,route:[],trackingEvents:[{event:"order_assigned",timestamp:new Date,location:null,note:"Order assigned to rider"}],createdAt:new Date,updatedAt:new Date}),[4,r.commit()];case 2:return l.sent(),[2,c.id];case 3:throw l.sent();case 4:return[2]}})}),function(e,t){return Q.apply(this,arguments)}),tp=(Z=(0,en._)(function(e,t,r){var n,a,s,i,o,u,c,l,d;return(0,eu.Jh)(this,function(h){switch(h.label){case 0:switch(h.trys.push([0,5,,6]),n=(0,ed.qs)(eg),a=(0,ed.JU)(eg,"orders",e),s={status:t,updatedAt:new Date},t){case"picked_up":s.pickedUpAt=new Date;break;case"out_for_delivery":s.outForDeliveryAt=new Date;break;case"delivered":s.deliveredAt=new Date,s.actualDeliveryTime=new Date,(null==r?void 0:r.deliveryProof)&&(s.deliveryProof=r.deliveryProof)}return n.update(a,s),i=(0,ed.IO)((0,ed.hJ)(eg,"order_tracking"),(0,ed.ar)("orderId","==",e)),[4,(0,ed.PL)(i)];case 1:if((o=h.sent()).empty||(c=(u=o.docs[0]).data().trackingEvents||[],n.update(u.ref,{status:t,trackingEvents:(0,eo._)(c).concat([{event:t,timestamp:new Date,location:(null==r?void 0:r.location)||null,note:(null==r?void 0:r.note)||"Order ".concat(t.replace("_"," "))}]),updatedAt:new Date})),"delivered"!==t)return[3,3];return[4,eA(e)];case 2:(null==(l=h.sent())?void 0:l.riderId)&&(d=(0,ed.JU)(eg,"riders",l.riderId),n.update(d,{status:"online",currentOrderId:null,completedDeliveries:(0,ed.nP)(1),totalDeliveries:(0,ed.nP)(1),lastActiveAt:new Date})),h.label=3;case 3:return[4,n.commit()];case 4:return h.sent(),[3,6];case 5:throw h.sent();case 6:return[2]}})}),function(e,t,r){return Z.apply(this,arguments)}),tg=($=(0,en._)(function(e){var t,r,n,a;return(0,eu.Jh)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=(0,ed.hJ)(eg,"order_tracking"),r=(0,ed.IO)(t,(0,ed.ar)("orderId","==",e)),[4,(0,ed.PL)(r)];case 1:if((n=s.sent()).empty)return[2,null];return a=n.docs[0],[2,(0,ea._)({id:a.id},a.data())];case 2:throw s.sent();case 3:return[2]}})}),function(e){return $.apply(this,arguments)}),tm=function(e,t){var r=(0,ed.hJ)(eg,"order_tracking"),n=(0,ed.IO)(r,(0,ed.ar)("orderId","==",e));return(0,ed.cf)(n,function(e){if(e.empty)t(null);else{var r=e.docs[0];t((0,ea._)({id:r.id},r.data()))}})},ty=(ee=(0,en._)(function(e,t){var r,n,a,s;return(0,eu.Jh)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),r=(0,ed.hJ)(eg,"order_tracking"),n=(0,ed.IO)(r,(0,ed.ar)("orderId","==",e)),[4,(0,ed.PL)(n)];case 1:if((a=i.sent()).empty)return[3,3];return s=a.docs[0],[4,(0,ed.r7)(s.ref,{riderLocation:t,updatedAt:new Date})];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:throw i.sent();case 5:return[2]}})}),function(e,t){return ee.apply(this,arguments)}),tw=function(e,t){var r=(t.lat-e.lat)*Math.PI/180,n=(t.lng-e.lng)*Math.PI/180,a=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371},tv=function(){var e=localStorage.getItem("currentRider");return e?JSON.parse(e):null},tb=function(e){localStorage.setItem("currentRider",JSON.stringify(e))},tD=function(){localStorage.removeItem("currentRider")},tP=function(){return null!==tv()},tS=(et=(0,en._)(function(e,t){var r,n;return(0,eu.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),r=(0,ed.hJ)(eg,"orders"),n=(0,ed.IO)(r,(0,ed.ar)("riderId","==",e),(0,ed.Xo)("createdAt","desc")),t&&(n=(0,ed.IO)(r,(0,ed.ar)("riderId","==",e),(0,ed.ar)("status","==",t),(0,ed.Xo)("createdAt","desc"))),[4,(0,ed.PL)(n)];case 1:return[2,a.sent().docs.map(function(e){return(0,ea._)({id:e.id},e.data())})];case 2:throw a.sent();case 3:return[2]}})}),function(e,t){return et.apply(this,arguments)}),t_=(er=(0,en._)(function(e){return(0,eu.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e.address&&!e.address.coordinates&&(e.address.coordinates={lat:0,lng:0}),[4,(0,ed.ET)((0,ed.hJ)(eg,"orders"),(0,es._)((0,ea._)({},e),{status:"pending",riderId:null,riderAssignedAt:null,pickedUpAt:null,outForDeliveryAt:null,deliveredAt:null,estimatedDeliveryTime:null,actualDeliveryTime:null,deliveryProof:null,createdAt:new Date,updatedAt:new Date}))];case 1:return[2,t.sent().id];case 2:throw t.sent();case 3:return[2]}})}),function(e){return er.apply(this,arguments)}),tJ=function(e,t){var r=(0,ed.hJ)(eg,"orders"),n=(0,ed.IO)(r,(0,ed.ar)("riderId","==",e),(0,ed.ar)("status","in",["assigned","picked_up","out_for_delivery"]),(0,ed.Xo)("createdAt","desc"));return(0,ed.cf)(n,function(e){t(e.docs.map(function(e){return(0,ea._)({id:e.id},e.data())}))})}}}]);